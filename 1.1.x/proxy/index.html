<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Article">
  

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Proxy Reference - v1.1.x | Kong - Open-Source API Management and Microservice Management</title>
  <meta name="description" content="Secure, Manage &amp; Extend your APIs or Microservices with plugins for authentication, logging, rate-limiting, transformations and more." />
  <meta name="author" content="KongHQ" />
  <meta property="og:title" content="Open-Source API Management and Microservice Management" />
  <meta property="og:site_name" content="Kong" />
  <!-- use share link for facebook -->
  <meta property="og:url" content="https://docs.konghq.com" />
  <meta property="og:description" content="Secure, Manage &amp; Extend your APIs or Microservices with plugins for authentication, logging, rate-limiting, transformations and more." />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="en_US" />
  <meta
    property="og:image"
    content="https://docs.konghq.com/assets/images/share.png"
  />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@thekonginc" />
  <meta name="twitter:creator" content="@thekonginc" />
  <meta name="twitter:url" content="https://docs.konghq.com" />
  <meta name="twitter:description" content="Secure, Manage &amp; Extend your APIs or Microservices with plugins for authentication, logging, rate-limiting, transformations and more." />
  <meta
    name="twitter:image"
    content="https://docs.konghq.com/assets/images/share.png"
  />
  <meta property="fb:admins" content="227304446" />
  <meta property="fb:admins" content="576641408" />
  <meta
    name="google-site-verification"
    content="CrU3zp02dNKTe8NSAipL4NCPkrIjDXG8fViTZ-MIzP4"
  />
  <link
    rel="stylesheet"
    href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"
    integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz"
    crossorigin="anonymous"
  />

  <!-- New Relic -->
  <script type="text/javascript">
/* eslint-disable */
window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var o=e[n]={exports:{}};t[n][0].call(o.exports,function(e){var o=t[n][1][e];return r(o||e)},o,o.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,n){function r(t){try{c.console&&console.log(t)}catch(e){}}var o,i=t("ee"),a=t(20),c={};try{o=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(c.console=!0,o.indexOf("dev")!==-1&&(c.dev=!0),o.indexOf("nr_dev")!==-1&&(c.nrDev=!0))}catch(s){}c.nrDev&&i.on("internal-error",function(t){r(t.stack)}),c.dev&&i.on("fn-err",function(t,e,n){r(n.stack)}),c.dev&&(r("NR AGENT IN DEVELOPMENT MODE"),r("flags: "+a(c,function(t,e){return t}).join(", ")))},{}],2:[function(t,e,n){function r(t,e,n,r,c){try{h?h-=1:o(c||new UncaughtException(t,e,n),!0)}catch(f){try{i("ierr",[f,s.now(),!0])}catch(d){}}return"function"==typeof u&&u.apply(this,a(arguments))}function UncaughtException(t,e,n){this.message=t||"Uncaught error with no additional information",this.sourceURL=e,this.line=n}function o(t,e){var n=e?null:s.now();i("err",[t,n])}var i=t("handle"),a=t(21),c=t("ee"),s=t("loader"),f=t("gos"),u=window.onerror,d=!1,p="nr@seenError",h=0;s.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(l){"stack"in l&&(t(13),t(12),"addEventListener"in window&&t(6),s.xhrWrappable&&t(14),d=!0)}c.on("fn-start",function(t,e,n){d&&(h+=1)}),c.on("fn-err",function(t,e,n){d&&!n[p]&&(f(n,p,function(){return!0}),this.thrown=!0,o(n))}),c.on("fn-end",function(){d&&!this.thrown&&h>0&&(h-=1)}),c.on("internal-error",function(t){i("ierr",[t,s.now(),!0])})},{}],3:[function(t,e,n){t("loader").features.ins=!0},{}],4:[function(t,e,n){function r(){M++,S=y.hash,this[u]=b.now()}function o(){M--,y.hash!==S&&i(0,!0);var t=b.now();this[l]=~~this[l]+t-this[u],this[d]=t}function i(t,e){E.emit("newURL",[""+y,e])}function a(t,e){t.on(e,function(){this[e]=b.now()})}var c="-start",s="-end",f="-body",u="fn"+c,d="fn"+s,p="cb"+c,h="cb"+s,l="jsTime",m="fetch",v="addEventListener",w=window,y=w.location,b=t("loader");if(w[v]&&b.xhrWrappable){var g=t(10),x=t(11),E=t(8),P=t(6),O=t(13),R=t(7),T=t(14),L=t(9),j=t("ee"),N=j.get("tracer");t(15),b.features.spa=!0;var S,M=0;j.on(u,r),j.on(p,r),j.on(d,o),j.on(h,o),j.buffer([u,d,"xhr-done","xhr-resolved"]),P.buffer([u]),O.buffer(["setTimeout"+s,"clearTimeout"+c,u]),T.buffer([u,"new-xhr","send-xhr"+c]),R.buffer([m+c,m+"-done",m+f+c,m+f+s]),E.buffer(["newURL"]),g.buffer([u]),x.buffer(["propagate",p,h,"executor-err","resolve"+c]),N.buffer([u,"no-"+u]),L.buffer(["new-jsonp","cb-start","jsonp-error","jsonp-end"]),a(T,"send-xhr"+c),a(j,"xhr-resolved"),a(j,"xhr-done"),a(R,m+c),a(R,m+"-done"),a(L,"new-jsonp"),a(L,"jsonp-end"),a(L,"cb-start"),E.on("pushState-end",i),E.on("replaceState-end",i),w[v]("hashchange",i,!0),w[v]("load",i,!0),w[v]("popstate",function(){i(0,M>1)},!0)}},{}],5:[function(t,e,n){function r(t){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var o=t("ee"),i=t("handle"),a=t(13),c=t(12),s="learResourceTimings",f="addEventListener",u="resourcetimingbufferfull",d="bstResource",p="resource",h="-start",l="-end",m="fn"+h,v="fn"+l,w="bstTimer",y="pushState",b=t("loader");b.features.stn=!0,t(8);var g=NREUM.o.EV;o.on(m,function(t,e){var n=t[0];n instanceof g&&(this.bstStart=b.now())}),o.on(v,function(t,e){var n=t[0];n instanceof g&&i("bst",[n,e,this.bstStart,b.now()])}),a.on(m,function(t,e,n){this.bstStart=b.now(),this.bstType=n}),a.on(v,function(t,e){i(w,[e,this.bstStart,b.now(),this.bstType])}),c.on(m,function(){this.bstStart=b.now()}),c.on(v,function(t,e){i(w,[e,this.bstStart,b.now(),"requestAnimationFrame"])}),o.on(y+h,function(t){this.time=b.now(),this.startPath=location.pathname+location.hash}),o.on(y+l,function(t){i("bstHist",[location.pathname+location.hash,this.startPath,this.time])}),f in window.performance&&(window.performance["c"+s]?window.performance[f](u,function(t){i(d,[window.performance.getEntriesByType(p)]),window.performance["c"+s]()},!1):window.performance[f]("webkit"+u,function(t){i(d,[window.performance.getEntriesByType(p)]),window.performance["webkitC"+s]()},!1)),document[f]("scroll",r,{passive:!0}),document[f]("keypress",r,!1),document[f]("click",r,!1)}},{}],6:[function(t,e,n){function r(t){for(var e=t;e&&!e.hasOwnProperty(u);)e=Object.getPrototypeOf(e);e&&o(e)}function o(t){c.inPlace(t,[u,d],"-",i)}function i(t,e){return t[1]}var a=t("ee").get("events"),c=t(23)(a,!0),s=t("gos"),f=XMLHttpRequest,u="addEventListener",d="removeEventListener";e.exports=a,"getPrototypeOf"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+"-start",function(t,e){var n=t[1],r=s(n,"nr@wrapped",function(){function t(){if("function"==typeof n.handleEvent)return n.handleEvent.apply(n,arguments)}var e={object:t,"function":n}[typeof n];return e?c(e,"fn-",null,e.name||"anonymous"):n});this.wrapped=t[1]=r}),a.on(d+"-start",function(t){t[1]=this.wrapped||t[1]})},{}],7:[function(t,e,n){function r(t,e,n){var r=t[e];"function"==typeof r&&(t[e]=function(){var t=r.apply(this,arguments);return o.emit(n+"start",arguments,t),t.then(function(e){return o.emit(n+"end",[null,e],t),e},function(e){throw o.emit(n+"end",[e],t),e})})}var o=t("ee").get("fetch"),i=t(20);e.exports=o;var a=window,c="fetch-",s=c+"body-",f=["arrayBuffer","blob","json","text","formData"],u=a.Request,d=a.Response,p=a.fetch,h="prototype";u&&d&&p&&(i(f,function(t,e){r(u[h],e,s),r(d[h],e,s)}),r(a,"fetch",c),o.on(c+"end",function(t,e){var n=this;e?e.clone().arrayBuffer().then(function(t){n.rxSize=t.byteLength,o.emit(c+"done",[null,e],n)}):o.emit(c+"done",[t],n)}))},{}],8:[function(t,e,n){var r=t("ee").get("history"),o=t(23)(r);e.exports=r,o.inPlace(window.history,["pushState","replaceState"],"-")},{}],9:[function(t,e,n){function r(t){function e(){s.emit("jsonp-end",[],p),t.removeEventListener("load",e,!1),t.removeEventListener("error",n,!1)}function n(){s.emit("jsonp-error",[],p),s.emit("jsonp-end",[],p),t.removeEventListener("load",e,!1),t.removeEventListener("error",n,!1)}var r=t&&"string"==typeof t.nodeName&&"script"===t.nodeName.toLowerCase();if(r){var o="function"==typeof t.addEventListener;if(o){var a=i(t.src);if(a){var u=c(a),d="function"==typeof u.parent[u.key];if(d){var p={};f.inPlace(u.parent,[u.key],"cb-",p),t.addEventListener("load",e,!1),t.addEventListener("error",n,!1),s.emit("new-jsonp",[t.src],p)}}}}}function o(){return"addEventListener"in window}function i(t){var e=t.match(u);return e?e[1]:null}function a(t,e){var n=t.match(p),r=n[1],o=n[3];return o?a(o,e[r]):e[r]}function c(t){var e=t.match(d);return e&&e.length>=3?{key:e[2],parent:a(e[1],window)}:{key:t,parent:window}}var s=t("ee").get("jsonp"),f=t(23)(s);if(e.exports=s,o()){var u=/[?&](?:callback|cb)=([^&#]+)/,d=/(.*)\.([^.]+)/,p=/^(\w+)(\.|$)(.*)$/,h=["appendChild","insertBefore","replaceChild"];f.inPlace(HTMLElement.prototype,h,"dom-"),f.inPlace(HTMLHeadElement.prototype,h,"dom-"),f.inPlace(HTMLBodyElement.prototype,h,"dom-"),s.on("dom-start",function(t){r(t[0])})}},{}],10:[function(t,e,n){var r=t("ee").get("mutation"),o=t(23)(r),i=NREUM.o.MO;e.exports=r,i&&(window.MutationObserver=function(t){return this instanceof i?new i(o(t,"fn-")):i.apply(this,arguments)},MutationObserver.prototype=i.prototype)},{}],11:[function(t,e,n){function r(t){var e=a.context(),n=c(t,"executor-",e),r=new f(n);return a.context(r).getCtx=function(){return e},a.emit("new-promise",[r,e],e),r}function o(t,e){return e}var i=t(23),a=t("ee").get("promise"),c=i(a),s=t(20),f=NREUM.o.PR;e.exports=a,f&&(window.Promise=r,["all","race"].forEach(function(t){var e=f[t];f[t]=function(n){function r(t){return function(){a.emit("propagate",[null,!o],i),o=o||!t}}var o=!1;s(n,function(e,n){Promise.resolve(n).then(r("all"===t),r(!1))});var i=e.apply(f,arguments),c=f.resolve(i);return c}}),["resolve","reject"].forEach(function(t){var e=f[t];f[t]=function(t){var n=e.apply(f,arguments);return t!==n&&a.emit("propagate",[t,!0],n),n}}),f.prototype["catch"]=function(t){return this.then(null,t)},f.prototype=Object.create(f.prototype,{constructor:{value:r}}),s(Object.getOwnPropertyNames(f),function(t,e){try{r[e]=f[e]}catch(n){}}),a.on("executor-start",function(t){t[0]=c(t[0],"resolve-",this),t[1]=c(t[1],"resolve-",this)}),a.on("executor-err",function(t,e,n){t[1](n)}),c.inPlace(f.prototype,["then"],"then-",o),a.on("then-start",function(t,e){this.promise=e,t[0]=c(t[0],"cb-",this),t[1]=c(t[1],"cb-",this)}),a.on("then-end",function(t,e,n){this.nextPromise=n;var r=this.promise;a.emit("propagate",[r,!0],n)}),a.on("cb-end",function(t,e,n){a.emit("propagate",[n,!0],this.nextPromise)}),a.on("propagate",function(t,e,n){this.getCtx&&!e||(this.getCtx=function(){if(t instanceof Promise)var e=a.context(t);return e&&e.getCtx?e.getCtx():this})}),r.toString=function(){return""+f})},{}],12:[function(t,e,n){var r=t("ee").get("raf"),o=t(23)(r),i="equestAnimationFrame";e.exports=r,o.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),r.on("raf-start",function(t){t[0]=o(t[0],"fn-")})},{}],13:[function(t,e,n){function r(t,e,n){t[0]=a(t[0],"fn-",null,n)}function o(t,e,n){this.method=n,this.timerDuration=isNaN(t[1])?0:+t[1],t[0]=a(t[0],"fn-",this,n)}var i=t("ee").get("timer"),a=t(23)(i),c="setTimeout",s="setInterval",f="clearTimeout",u="-start",d="-";e.exports=i,a.inPlace(window,[c,"setImmediate"],c+d),a.inPlace(window,[s],s+d),a.inPlace(window,[f,"clearImmediate"],f+d),i.on(s+u,r),i.on(c+u,o)},{}],14:[function(t,e,n){function r(t,e){d.inPlace(e,["onreadystatechange"],"fn-",c)}function o(){var t=this,e=u.context(t);t.readyState>3&&!e.resolved&&(e.resolved=!0,u.emit("xhr-resolved",[],t)),d.inPlace(t,y,"fn-",c)}function i(t){b.push(t),l&&(x?x.then(a):v?v(a):(E=-E,P.data=E))}function a(){for(var t=0;t<b.length;t++)r([],b[t]);b.length&&(b=[])}function c(t,e){return e}function s(t,e){for(var n in t)e[n]=t[n];return e}t(6);var f=t("ee"),u=f.get("xhr"),d=t(23)(u),p=NREUM.o,h=p.XHR,l=p.MO,m=p.PR,v=p.SI,w="readystatechange",y=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],b=[];e.exports=u;var g=window.XMLHttpRequest=function(t){var e=new h(t);try{u.emit("new-xhr",[e],e),e.addEventListener(w,o,!1)}catch(n){try{u.emit("internal-error",[n])}catch(r){}}return e};if(s(h,g),g.prototype=h.prototype,d.inPlace(g.prototype,["open","send"],"-xhr-",c),u.on("send-xhr-start",function(t,e){r(t,e),i(e)}),u.on("open-xhr-start",r),l){var x=m&&m.resolve();if(!v&&!m){var E=1,P=document.createTextNode(E);new l(a).observe(P,{characterData:!0})}}else f.on("fn-end",function(t){t[0]&&t[0].type===w||a()})},{}],15:[function(t,e,n){function r(t){var e=this.params,n=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<d;r++)t.removeEventListener(u[r],this.listener,!1);if(!e.aborted){if(n.duration=a.now()-this.startTime,4===t.readyState){e.status=t.status;var i=o(t,this.lastSize);if(i&&(n.rxSize=i),this.sameOrigin){var s=t.getResponseHeader("X-NewRelic-App-Data");s&&(e.cat=s.split(", ").pop())}}else e.status=0;n.cbTime=this.cbTime,f.emit("xhr-done",[t],t),c("xhr",[e,n,this.startTime])}}}function o(t,e){var n=t.responseType;if("json"===n&&null!==e)return e;var r="arraybuffer"===n||"blob"===n||"json"===n?t.response:t.responseText;return l(r)}function i(t,e){var n=s(e),r=t.params;r.host=n.hostname+":"+n.port,r.pathname=n.pathname,t.sameOrigin=n.sameOrigin}var a=t("loader");if(a.xhrWrappable){var c=t("handle"),s=t(16),f=t("ee"),u=["load","error","abort","timeout"],d=u.length,p=t("id"),h=t(19),l=t(18),m=window.XMLHttpRequest;a.features.xhr=!0,t(14),f.on("new-xhr",function(t){var e=this;e.totalCbs=0,e.called=0,e.cbTime=0,e.end=r,e.ended=!1,e.xhrGuids={},e.lastSize=null,h&&(h>34||h<10)||window.opera||t.addEventListener("progress",function(t){e.lastSize=t.loaded},!1)}),f.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),f.on("open-xhr-end",function(t,e){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&e.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),f.on("send-xhr-start",function(t,e){var n=this.metrics,r=t[0],o=this;if(n&&r){var i=l(r);i&&(n.txSize=i)}this.startTime=a.now(),this.listener=function(t){try{"abort"===t.type&&(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof e.onload))&&o.end(e)}catch(n){try{f.emit("internal-error",[n])}catch(r){}}};for(var c=0;c<d;c++)e.addEventListener(u[c],this.listener,!1)}),f.on("xhr-cb-time",function(t,e,n){this.cbTime+=t,e?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof n.onload||this.end(n)}),f.on("xhr-load-added",function(t,e){var n=""+p(t)+!!e;this.xhrGuids&&!this.xhrGuids[n]&&(this.xhrGuids[n]=!0,this.totalCbs+=1)}),f.on("xhr-load-removed",function(t,e){var n=""+p(t)+!!e;this.xhrGuids&&this.xhrGuids[n]&&(delete this.xhrGuids[n],this.totalCbs-=1)}),f.on("addEventListener-end",function(t,e){e instanceof m&&"load"===t[0]&&f.emit("xhr-load-added",[t[1],t[2]],e)}),f.on("removeEventListener-end",function(t,e){e instanceof m&&"load"===t[0]&&f.emit("xhr-load-removed",[t[1],t[2]],e)}),f.on("fn-start",function(t,e,n){e instanceof m&&("onload"===n&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=a.now()))}),f.on("fn-end",function(t,e){this.xhrCbStart&&f.emit("xhr-cb-time",[a.now()-this.xhrCbStart,this.onload,e],e)})}},{}],16:[function(t,e,n){e.exports=function(t){var e=document.createElement("a"),n=window.location,r={};e.href=t,r.port=e.port;var o=e.href.split("://");!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=e.hostname||n.hostname,r.pathname=e.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var i=!e.protocol||":"===e.protocol||e.protocol===n.protocol,a=e.hostname===document.domain&&e.port===n.port;return r.sameOrigin=i&&(!e.hostname||a),r}},{}],17:[function(t,e,n){function r(){}function o(t,e,n){return function(){return i(t,[f.now()].concat(c(arguments)),e?null:this,n),e?void 0:this}}var i=t("handle"),a=t(20),c=t(21),s=t("ee").get("tracer"),f=t("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],p="api-",h=p+"ixn-";a(d,function(t,e){u[e]=o(p+e,!0,"api")}),u.addPageAction=o(p+"addPageAction",!0),u.setCurrentRouteName=o(p+"routeName",!0),e.exports=newrelic,u.interaction=function(){return(new r).get()};var l=r.prototype={createTracer:function(t,e){var n={},r=this,o="function"==typeof e;return i(h+"tracer",[f.now(),t,n],r),function(){if(s.emit((o?"":"no-")+"fn-start",[f.now(),r,o],n),o)try{return e.apply(this,arguments)}catch(t){throw s.emit("fn-err",[arguments,this,t],n),t}finally{s.emit("fn-end",[f.now()],n)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,e){l[e]=o(h+e)}),newrelic.noticeError=function(t){"string"==typeof t&&(t=new Error(t)),i("err",[t,f.now()])}},{}],18:[function(t,e,n){e.exports=function(t){if("string"==typeof t&&t.length)return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!("undefined"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(e){return}}}},{}],19:[function(t,e,n){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o&&(r=+o[1]),e.exports=r},{}],20:[function(t,e,n){function r(t,e){var n=[],r="",i=0;for(r in t)o.call(t,r)&&(n[i]=e(r,t[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;e.exports=r},{}],21:[function(t,e,n){function r(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,o=n-e||0,i=Array(o<0?0:o);++r<o;)i[r]=t[e+r];return i}e.exports=r},{}],22:[function(t,e,n){e.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],23:[function(t,e,n){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t("ee"),i=t(21),a="nr@original",c=Object.prototype.hasOwnProperty,s=!1;e.exports=function(t,e){function n(t,e,n,o){function nrWrapper(){var r,a,c,s;try{a=this,r=i(arguments),c="function"==typeof n?n(r,a):n||{}}catch(f){p([f,"",[r,a,o],c])}u(e+"start",[r,a,o],c);try{return s=t.apply(a,r)}catch(d){throw u(e+"err",[r,a,d],c),d}finally{u(e+"end",[r,a,s],c)}}return r(t)?t:(e||(e=""),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,e,o,i){o||(o="");var a,c,s,f="-"===o.charAt(0);for(s=0;s<e.length;s++)c=e[s],a=t[c],r(a)||(t[c]=n(a,f?c+o:o,i,c))}function u(n,r,o){if(!s||e){var i=s;s=!0;try{t.emit(n,r,o,e)}catch(a){p([a,n,r,o])}s=i}}function d(t,e){if(Object.defineProperty&&Object.keys)try{var n=Object.keys(t);return n.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(r){p([r])}for(var o in t)c.call(t,o)&&(e[o]=t[o]);return e}function p(e){try{t.emit("internal-error",e)}catch(n){}}return t||(t=o),n.inPlace=f,n.flag=a,n}},{}],ee:[function(t,e,n){function r(){}function o(t){function e(t){return t&&t instanceof r?t:t?s(t,c,i):i()}function n(n,r,o,i){if(!p.aborted||i){t&&t(n,r,o);for(var a=e(o),c=l(n),s=c.length,f=0;f<s;f++)c[f].apply(a,r);var d=u[y[n]];return d&&d.push([b,n,r,a]),a}}function h(t,e){w[t]=l(t).concat(e)}function l(t){return w[t]||[]}function m(t){return d[t]=d[t]||o(n)}function v(t,e){f(t,function(t,n){e=e||"feature",y[n]=e,e in u||(u[e]=[])})}var w={},y={},b={on:h,emit:n,get:m,listeners:l,context:e,buffer:v,abort:a,aborted:!1};return b}function i(){return new r}function a(){(u.api||u.feature)&&(p.aborted=!0,u=p.backlog={})}var c="nr@context",s=t("gos"),f=t(20),u={},d={},p=e.exports=o();p.backlog=u},{}],gos:[function(t,e,n){function r(t,e,n){if(o.call(t,e))return t[e];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[e]=r,r}var o=Object.prototype.hasOwnProperty;e.exports=r},{}],handle:[function(t,e,n){function r(t,e,n,r){o.buffer([t],r),o.emit(t,e,n)}var o=t("ee").get("handle");e.exports=r,r.ee=o},{}],id:[function(t,e,n){function r(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i="nr@id",a=t("gos");e.exports=r},{}],loader:[function(t,e,n){function r(){if(!x++){var t=g.info=NREUM.info,e=p.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&e))return u.abort();f(y,function(e,n){t[e]||(t[e]=n)}),s("mark",["onload",a()+g.offset],null,"api");var n=p.createElement("script");n.src="https://"+t.agent,e.parentNode.insertBefore(n,e)}}function o(){"complete"===p.readyState&&i()}function i(){s("mark",["domContent",a()+g.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(c=Math.max((new Date).getTime(),c))-g.offset}var c=(new Date).getTime(),s=t("handle"),f=t(20),u=t("ee"),d=window,p=d.document,h="addEventListener",l="attachEvent",m=d.XMLHttpRequest,v=m&&m.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:m,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var w=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-spa-1071.min.js"},b=m&&v&&v[h]&&!/CriOS/.test(navigator.userAgent),g=e.exports={offset:c,now:a,origin:w,features:{},xhrWrappable:b};t(17),p[h]?(p[h]("DOMContentLoaded",i,!1),d[h]("load",r,!1)):(p[l]("onreadystatechange",o),d[l]("onload",r)),s("mark",["firstbyte",c],null,"api");var x=0,E=t(22)},{}]},{},["loader",2,15,5,3,4]);
;NREUM.info={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",licenseKey:"13e44ec848",applicationID:"187820761",sa:1}
</script>


  <!-- FullStory -->
  <!-- <script>
/* eslint-disable */
window['_fs_debug'] = false;
window['_fs_host'] = 'fullstory.com';
window['_fs_org'] = '7JS2S';
window['_fs_namespace'] = 'FS';
(function(m,n,e,t,l,o,g,y){
    if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window["_fs_namespace"].');} return;}
    g=m[e]=function(a,b){g.q?g.q.push([a,b]):g._api(a,b);};g.q=[];
    o=n.createElement(t);o.async=1;o.src='https://'+_fs_host+'/s/fs.js';
    y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);
    g.identify=function(i,v){g(l,{uid:i});if(v)g(l,v)};g.setUserVars=function(v){g(l,v)};g.event=function(i,v){g('event',{n:i,p:v})};
    g.shutdown=function(){g("rec",!1)};g.restart=function(){g("rec",!0)};
    g.consent=function(a){g("consent",!arguments.length||a)};
    g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};
    g.clearUserCookie=function(){};
})(window,document,window['_fs_namespace'],'script','user');
</script>
 -->

  <!-- Delighted -->
  <script type="text/javascript">
/* eslint-disable */
  !function(e,t,r,n,a){if(!e[a]){for(var i=e[a]=[],s=0;s<r.length;s++){var c=r[s];i[c]=i[c]||function(e){return function(){var t=Array.prototype.slice.call(arguments);i.push([e,t])}}(c)}i.SNIPPET_VERSION="1.0.1";var o=t.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://d2yyd1h5u9mauk.cloudfront.net/integrations/web/v1/library/"+n+"/"+a+".js";var u=t.getElementsByTagName("script")[0];u.parentNode.insertBefore(o,u)}}(window,document,["survey","reset","config","init","set","get","event","identify","track","page","screen","group","alias"],"Mvwmq6n6DhInaFYu","delighted");

  delighted.survey();
</script>


  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "name": "KongHQ",
      "url": "https://docs.konghq.com",
      "logo": "https://docs.konghq.com/assets/images/logo.png",
      "sameAs": [
        "https://www.facebook.com/konginc",
        "https://twitter.com/thekonginc",
        "https://plus.google.com/+mashape"
      ]
    }
  </script>

  <!-- Preload assets -->
  <link rel="dns-prefetch" href="//cloud.typography.com" />
  <link
    href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700"
    rel="stylesheet"
  />
  <link rel="dns-prefetch" href="//dev.visualwebsiteoptimizer.com" />
  <link rel="dns-prefetch" href="//cdn.segment.com" />

  <!-- Recaptcha -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>

  <!-- ##gulp-resource-hints## -->

  <link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico" />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"
  />
  <link
    rel="stylesheet"
    href="/assets/styles.css?v=1591123015"
  />

  <script>
    !(function(w) {
      var clearbit = (w.clearbit = w.clearbit || []);
      if (!clearbit.initialize)
        if (clearbit.invoked)
          w.console &&
            console.error &&
            console.error("Clearbit snippet included twice.");
        else {
          clearbit.invoked = !0;
          clearbit.methods = [
            "trackSubmit",
            "trackClick",
            "trackLink",
            "trackForm",
            "pageview",
            "identify",
            "reset",
            "group",
            "track",
            "ready",
            "alias",
            "page",
            "once",
            "off",
            "on"
          ];
          clearbit.factory = function(t) {
            return function() {
              var e = Array.prototype.slice.call(arguments);
              e.unshift(t);
              clearbit.push(e);
              return clearbit;
            };
          };
          for (var t = 0; t < clearbit.methods.length; t++) {
            var e = clearbit.methods[t];
            clearbit[e] = clearbit.factory(e);
          }
          clearbit.load = function(t) {
            var e = document.createElement("script");
            e.async = !0;
            e.src =
              ("https:" === document.location.protocol
                ? "https://"
                : "http://") +
              "x.clearbitjs.com/v1/" +
              t +
              "/clearbit.js";
            var n = document.getElementsByTagName("script")[0];
            n.parentNode.insertBefore(e, n);
          };
          clearbit.SNIPPET_VERSION = "3.1.0";
          clearbit.load("pk_1bdbdbad26342e32516473510e95c3ff");
          clearbit.page();
        }
    })(window);
  </script>

  
</head>

<!-- Kong Cookie Policy -->
<div class="cookie-policy-container">
  <p>In order to give you better service we use cookies. By continuing to use our website, you agree to the use of cookies as described in our <a href=" https://konghq.com/cookie-policy/">Cookie Policy</a>
  <button class="cookie-policy-accept btn button" type="submit">I Agree</button>
</div>



  <body
    id=""
    
    data-spy="scroll"
    data-target="#scroll-sidebar"
    data-offset="350"
  >
    <header class="navbar navbar-inverse navbar-toggleable-lg kong-navbar flex-row align-items-center fixed-top lower_nav expand">
  <div class="container d-flex">
    <a href="https://konghq.com/" class="navbar-brand col col-xl-auto">
    <img src="https://2tjosk2rxzc21medji3nfn1g-wpengine.netdna-ssl.com/wp-content/themes/konghq/assets/img/gradient-logo.svg" alt="Kong Logo">
    </a>
    <button class="navbar-toggler align-self-center" type="button" data-toggle="kong-expand" data-target="#pagesNav" aria-controls="pagesNav" aria-expanded="false" aria-label="Toggle navigation">
      <div></div>
      <div></div>
      <div></div>
    </button>
    <nav class="navbar full-width">
      <div class="collapse navbar-collapse col justify-content-md-end kong-navbar_nav">
        <ul id="menu-primary-nav" class="menu">
          <li class="btn menu-item menu-item-type-custom menu-item-object-custom menu-item-12447 navbar-item"><a href="https://konghq.com/request-demo?itm_source=website&itm_medium=nav" class="nav-link">Request Demo</a></li>
          <li class="btn menu-item menu-item-type-custom menu-item-object-custom menu-item-12448 navbar-item"><a href="https://konghq.com/install?itm_source=website&itm_medium=nav" class="nav-link">Install</a></li>
          <li class="two-row nav1 menu-item menu-item-type-custom menu-item-object-custom current-menu-ancestor menu-item-has-children menu-item-12449 navbar-item">
            <a href="#" class="nav-link">Products</a>
            <ul class="sub-menu">
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom current-menu-ancestor current-menu-parent menu-item-has-children menu-item-12450 navbar-item">
                <a href="https://konghq.com/kong?itm_source=website&itm_medium=nav" class="nav-link">Kong Gateway</a>
                <div class="nav-btns"><a class="navbtn" href="https://konghq.com/install?itm_source=website&itm_medium=nav">Install Kong Open Source</a></div>
                <ul class="sub-menu">
                  <li class="mobile-nav menu-item menu-item-type-custom menu-item-object-custom menu-item-12451 navbar-item"><a href="https://konghq.com/kong?itm_source=website&itm_medium=nav" class="nav-link">Overview</a></li>
                  <li class="stacked menu-item menu-item-type-custom menu-item-object-custom current-menu-item menu-item-12452 navbar-item">
                    <a href="https://konghq.com/products/kong-gateway/control-api?itm_source=website&itm_medium=nav" aria-current="page" class="nav-link">
                      <img src="/assets/images/nav/control.svg"> Control API
                      <p class="description">Own your Kong experience to customize your API and microservices workflows.</p>
                    </a>
                  </li>
                  <li id="menu-item-12453" class="nav3 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12453 navbar-item">
                    <a href="https://konghq.com/products/kong-gateway/kong-proxy?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/proxy.svg"> Kong Proxy
                      <p class="description">Deliver performance needed for microservices, service mesh, and cloud native deployments.</p>
                    </a>
                    <ul class="sub-menu">
                      <li class="mobile-nav menu-item menu-item-type-custom menu-item-object-custom menu-item-12466 navbar-item"><a href="https://konghq.com/products/kong-gateway/kong-proxy?itm_source=website&itm_medium=nav" class="nav-link">Overview</a></li>
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12467 navbar-item"><a href="https://konghq.com/products/kong-enterprise/multi-protocol?itm_source=website&itm_medium=nav" class="nav-link">Multi-protocol</a></li>
                    </ul>
                  </li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12454 navbar-item">
                    <a href="https://konghq.com/products/kong-gateway/kong-plugins?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/plugins.svg"> Kong Plugins
                      <p class="description">Unleash the full power of Kong with a robust ecosystem of plugins.</p>
                    </a>
                  </li>
                </ul>
              </li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12455 navbar-item">
                <a href="https://konghq.com/products/kong-enterprise?itm_source=website&itm_medium=nav" class="nav-link">Kong Enterprise</a>
                <div class="nav-btns"><a class="navbtn" href="https://konghq.com/request-demo?itm_source=website&itm_medium=nav">Demo</a><a class="navbtn" href="https://konghq.com/products/kong-enterprise/free-trial?itm_source=website&itm_medium=nav">Free Trial</a></div>
                <ul class="sub-menu">
                  <li class="mobile-nav menu-item menu-item-type-custom menu-item-object-custom menu-item-12456 navbar-item"><a href="https://konghq.com/products/kong-enterprise" class="nav-link">Overview</a></li>
                  <li class="nav3 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12457 navbar-item">
                    <a href="https://konghq.com/products/kong-enterprise/kong-manager?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/manager.svg"> Kong Manager
                      <p class="description">Monitor and manage all your services with a consumer-grade interface.</p>
                    </a>
                    <ul class="sub-menu">
                      <li class="mobile-nav menu-item menu-item-type-custom menu-item-object-custom menu-item-12458 navbar-item"><a href="https://konghq.com/products/kong-enterprise/kong-manager?itm_source=website&itm_medium=nav" class="nav-link">Overview</a></li>
                    </ul>
                  </li>
                  <li class="nav3 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12461 navbar-item">
                    <a href="https://konghq.com/products/kong-enterprise/teams?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/teams.svg"> Teams
                      <p class="description">Organize developers and assign permissions to improve efficiency and compliance.</p>
                    </a>
                    <ul class="sub-menu">
                      <li class="mobile-nav menu-item menu-item-type-custom menu-item-object-custom menu-item-12462 navbar-item"><a href="https://konghq.com/products/kong-enterprise/teams?itm_source=website&itm_medium=nav" class="nav-link">Overview</a></li>
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12463 navbar-item"><a href="https://konghq.com/products/kong-enterprise/role-based-access-control?itm_source=website&itm_medium=nav" class="nav-link">RBAC</a></li>
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12464 navbar-item"><a href="https://konghq.com/products/kong-enterprise/workspaces?itm_source=website&itm_medium=nav" class="nav-link">Workspaces</a></li>
                    </ul>
                  </li>
                  <li class="nav3 menu-item menu-item-type-custom menu-item-object-custom menu-item-12465 navbar-item">
                    <a href="https://konghq.com/products/kong-enterprise/kong-studio?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/studio.svg"> Kong Studio
                      <p class="description">Empower your developers with the Kong Studio Integrated Development Environment.</p>
                    </a>
                  </li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12468 navbar-item">
                    <a href="https://konghq.com/products/kong-enterprise/dev-portal?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/dev-portal.svg"> Dev Portal
                      <p class="description">Accelerate innovation across your organization with the Kong Developer Portal.</p>
                    </a>
                  </li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12469 navbar-item">
                    <a href="https://konghq.com/products/kong-enterprise/kong-brain?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/brain-updated.svg"> Brain
                      <p class="description">Automatically standardize documentation and create a visual map of your services.</p>
                    </a>
                  </li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12470 navbar-item">
                    <a href="https://konghq.com/products/kong-enterprise/kong-immunity?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/immunity.svg"> Immunity
                      <p class="description">Autonomously identify service issues with machine learning-powered anomaly detection.</p>
                    </a>
                  </li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12468 navbar-item">
                    <a href="https://konghq.com/products/kong-enterprise/kong-kubernetes?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/icn-kubernetes.svg"> Kong for Kubernetes
                      <p class="description">The only fully native Kubernetes Ingress Controller for enhanced API management.</p>
                    </a>
                  </li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12469 navbar-item">
                    <a href="https://konghq.com/products/kong-enterprise/enterprise-plugins?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/icn-enterprise-plugins.svg"> Enterprise Plugins
                      <p class="description">Instantly implement policies built for global scale with Kong Enterprise Plugins.</p>
                    </a>
                  </li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12470 navbar-item">
                    <a href="https://konghq.com/products/kong-enterprise/kong-immunity?itm_source=website&itm_medium=nav" class="nav-link">
                      <img src="/assets/images/nav/icn-vitals.svg"> Vitals
                      <p class="description">Monitor your Kong Enterprise health and microservice API transactions traversing Kong.</p>
                    </a>
                  </li>
                </ul>
              </li>
            </ul>
          </li>
          <li id="menu-item-12471" class="multicol wide nav1 toplabel menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12471 navbar-item"><a href="#" class="nav-link solutions">Solutions</a>
            <ul class="sub-menu">
              <li id="menu-item-12472" class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12472 navbar-item"><a href="#" class="nav-link use-cases">Use Cases</a>
              <ul class="sub-menu">
                <li id="menu-item-12473" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12473 navbar-item"><a href="https://konghq.com/solutions/use-cases/decentralize-applications-and-services?itm_source=website&amp;itm_medium=nav" class="nav-link decentralize-apps-and-services<p-class=&quot;description&quot;>accelerate-your-journey-into-microservices</p>">Decentralize Apps and Services<p class="description">Accelerate your journey into microservices</p></a></li>
                <li id="menu-item-14131" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-14131 navbar-item"><a href="https://konghq.com/solutions/use-cases/secure-and-govern-apis-and-services/?itm_source=website&amp;itm_medium=nav" class="nav-link secure-and-govern-apis<p-class=&quot;description&quot;>empower-teams-to-provide-security,-governance-and-compliance</p>">Secure and Govern APIs<p class="description">Empower teams to provide security, governance and compliance</p></a></li>
                <li id="menu-item-17469" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17469 navbar-item"><a href="https://konghq.com/solutions/use-cases/create-a-developer-platform/?itm_source=website&amp;itm_medium=nav" class="nav-link create-a-developer-platform<p-class=&quot;description&quot;>rapidly-design,-publish-and-consume-apis-and-services</p>">Create a Developer Platform<p class="description">Rapidly design, publish and consume APIs and services</p></a></li>
              </ul>
            </li>
              <li id="menu-item-17470" class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-17470 navbar-item"><a href="#" class="nav-link deployment-patterns">Deployment Patterns</a>
              <ul class="sub-menu">
                <li id="menu-item-17471" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17471 navbar-item"><a href="https://konghq.com/solutions/gateway/?itm_source=website&amp;itm_medium=nav" class="nav-link api-gateway<p-class=&quot;description&quot;>take-control-of-your-microservices-with-the-world's-most-popular-api-gateway</p>">API Gateway<p class="description">Take control of your microservices with the worldâ€™s most popular API gateway</p></a></li>
                <li id="menu-item-17472" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17472 navbar-item"><a href="https://konghq.com/solutions/kubernetes-ingress/?itm_source=website&amp;itm_medium=nav" class="nav-link kubernetes<p-class=&quot;description&quot;>own-your-kubernetes-cluster-by-using-kong-as-an-ingress-controller</p>">Kubernetes<p class="description">Own your Kubernetes cluster by using Kong as an Ingress Controller</p></a></li>
                <li id="menu-item-17473" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-17473 navbar-item"><a target="_blank" rel="noopener noreferrer" href="https://kuma.io/?itm_source=website&amp;itm_medium=nav" class="nav-link service-mesh<p-class=&quot;description&quot;>build,-secure-and-observe-your-modern-service-mesh</p>">Service Mesh<p class="description">Build, secure and observe your modern Service Mesh</p></a></li>
              </ul>
            </li>
            </ul>
            </li>
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12471 navbar-item">
              <a href="/hub" class="nav-link">Plugins</a>
          </li>
          <li class="one-col nav1 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12475 navbar-item">
            <a href="#" class="nav-link">Open Source</a>
            <ul class="sub-menu">
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12476 navbar-item"><a href="https://konghq.com/install?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/install.svg"> Install Kong Gateway</a></li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12477 navbar-item"><a href="https://konghq.com/community?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/community.svg"> Kong Community</a></li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12478 navbar-item"><a target="_blank" href="https://github.com/Kong/kubernetes-ingress-controller" class="nav-link"><img src="/assets/images/nav/kubernetes.svg"> Kubernetes Ingress</a></li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12479 navbar-item"><a target="_blank" href="https://kuma.io" class="nav-link"><img src="/assets/images/nav/kuma.svg"> Kuma</a></li>
              <li class="nav2 hidden menu-item menu-item-type-custom menu-item-object-custom menu-item-12480 navbar-item"><a target="_blank" href="https://insomnia.rest/" class="nav-link"><img src="/assets/images/nav/insomnia.svg"> Insomnia</a></li>
            </ul>
          </li>
          <li class="multicol wide nav1 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12481 navbar-item docs">
            <a target="_blank" href="https://docs.konghq.com/?itm_source=website&itm_medium=nav" class="nav-link">Docs</a>
            <ul class="sub-menu">
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12482 navbar-item">
                <a class="nav-link">Get Started</a>
                <ul class="sub-menu">
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12484 navbar-item"><a href="https://konghq.com/install?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/install-thick.svg"> Install Kong Gateway</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12485 navbar-item"><a target="_blank" href="https://docs.konghq.com/enterprise/1.5.x/deployment/installation/overview/?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/getting-started-thick.svg"> Install Kong Enterprise</a></li>
                </ul>
              </li>
              <li id="menu-item-12483" class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12483 navbar-item">
                <a class="nav-link">Learn</a>
                <ul class="sub-menu">
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12486 navbar-item"><a target="_blank" href="https://docs.konghq.com/?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/deploy-plugins-master-launch.svg"> Kong Gateway</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12487 navbar-item"><a target="_blank" href="https://docs.konghq.com/enterprise/?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/deploy-plugins-master-launch.svg"> Kong Enterprise</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12488 navbar-item"><a target="_blank" href="https://docs.konghq.com/studio/?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/deploy-plugins-master-launch.svg"> Kong Studio</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12489 navbar-item"><a target="_blank" href="https://docs.konghq.com/hub/?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/deploy-plugins-master-launch.svg"> Plugins Hub</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li class="multicol nav1 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12490 navbar-item">
            <a href="#" class="nav-link">Resources</a>
            <ul class="sub-menu">
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12491 navbar-item">
                <a class="nav-link">Learning</a>
                <ul class="sub-menu">
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12495 navbar-item"><a href="https://konghq.com/resources/?content=ebooks&itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/ebooks.svg"> eBooks</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12496 navbar-item"><a href="https://konghq.com/resources/?content=webinars&itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/webinars.svg"> Webinars</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12497 navbar-item"><a href="https://konghq.com/resources/?content=whitepaper&itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/briefs.svg"> Briefs</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12494 navbar-item"><a href="https://konghq.com/blog?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/blog.svg"> Blog</a></li>
                </ul>
              </li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12492 navbar-item">
                <a class="nav-link">Community</a>
                <ul class="sub-menu">
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12500 navbar-item"><a href="https://konghq.com/community?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/meetups.svg"> Community</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12498 navbar-item"><a target="_blank" href="https://discuss.konghq.com/?_ga=2.147363831.1919773651.1569859116-132287075.1554308608" class="nav-link"><img src="/assets/images/nav/kong-nation.svg"> Kong Nation</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12501 navbar-item"><a href="https://konghq.com/kong-summit?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/summit.svg"> Kong Summit</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12499 navbar-item"><a target="_blank" href="https://github.com/Kong/" class="nav-link"><img src="/assets/images/nav/github.svg"> GitHub</a></li>
                </ul>
              </li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12493 navbar-item">
                <a class="nav-link">Support</a>
                <ul class="sub-menu">
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12502 navbar-item"><a target="_blank" href="https://support.konghq.com/s/?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/support-faqs.svg"> Enterprise Support Portal</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12503 navbar-item"><a href="https://konghq.com/faqs?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/support-faqs.svg"> FAQS</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12502 navbar-item"><a href="https://konghq.com/support/kong-professional-services?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/support-faqs.svg"> Kong Professional Services</a></li>
                  <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-12503 navbar-item"><a href="https://konghq.com/support/kong-university/?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/support-faqs.svg"> Kong University</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li id="menu-item-12504" class="one-col icn-sm nav1 menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-12504 navbar-item">
            <a href="#" class="nav-link">Company</a>
            <ul class="sub-menu">
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12505 navbar-item"><a href="https://konghq.com/about-kong-inc?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/about.svg"> About</a></li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12505 navbar-item"><a href="https://konghq.com/customers?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/meetups.svg"> Customers</a></li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12506 navbar-item"><a href="https://konghq.com/investors?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/investors.svg"> Investors</a></li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12507 navbar-item"><a href="https://konghq.com/careers?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/careers.svg"> Careers</a></li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12508 navbar-item"><a href="https://konghq.com/partners?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/partners.svg"> Partners</a></li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12509 navbar-item"><a href="https://konghq.com/press-room?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/press.svg"> Press</a></li>
              <li class="nav2 menu-item menu-item-type-custom menu-item-object-custom menu-item-12510 navbar-item"><a href="https://konghq.com/contact?itm_source=website&itm_medium=nav" class="nav-link"><img src="/assets/images/nav/contact.svg"> Contact</a></li>
            </ul>
          </li>
          <li class="demo-btn menu-item menu-item-type-custom menu-item-object-custom menu-item-12511 navbar-item"><a href="https://konghq.com/request-demo?itm_source=website&itm_medium=nav" class="nav-link">Request Demo</a></li>
        </ul>
      </div>
    </nav>
  </div>
</header>


    <div class="page v2  ">
  <header class="page-header">
    
    <div class="container">
      <nav class="docs-navigation v2">
        <a href="/"  class="active" >Kong Gateway</a>
        <a href="/enterprise" >Kong Enterprise</a>
        <a href="/getting-started-guide/latest/overview" >Getting Started</a>

        <div class="edit-this-page v2">
          <a target="_blank" href="https://github.com/Kong/docs.konghq.com/tree/master/app/1.1.x/proxy.md">
            <i class="fa fa-pencil"></i>
            <span>Edit this Page</span>
          </a>
        </div>
      </nav>

      <div class="title-version-search-container">
        <div class="page-header-title">
          <h1>Proxy Reference</h1>
        </div>
        <div class="search-version-row">
          <div class="versions-dropdown dropdown no-right-border">
            <button class="page-header-btn" id="version-dropdown" type="button" data-toggle="dropdown" aria-haspopup="true"
                    aria-expanded="false">
              Version 1.1.x
              
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="version-dropdown">
              
              
              
              <li >
                <a href="/2.0.x/proxy/"
                    
                >
                  2.0.x
                  <em>(latest)</em>
                </a>
              </li>
              
              
              
              <li >
                <a href="/1.5.x/proxy/"
                    
                >
                  1.5.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/1.4.x/proxy/"
                    
                >
                  1.4.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/1.3.x/proxy/"
                    
                >
                  1.3.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/1.2.x/proxy/"
                    
                >
                  1.2.x
                  
                </a>
              </li>
              
              
              
              <li  class="active" >
                <a href="/1.1.x/proxy/"
                     class="active" 
                >
                  1.1.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/1.0.x/proxy/"
                    
                >
                  1.0.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.14.x/proxy/"
                    
                >
                  0.14.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.13.x/proxy/"
                    
                >
                  0.13.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.12.x/proxy/"
                    
                >
                  0.12.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.11.x/proxy/"
                    
                >
                  0.11.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.10.x/proxy/"
                    
                >
                  0.10.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.9.x/proxy/"
                    
                >
                  0.9.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.8.x/proxy/"
                    
                >
                  0.8.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.7.x/proxy/"
                    
                >
                  0.7.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.6.x/proxy/"
                    
                >
                  0.6.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.5.x/proxy/"
                    
                >
                  0.5.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.4.x/proxy/"
                    
                >
                  0.4.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.3.x"
                    
                >
                  0.3.x
                  
                </a>
              </li>
              
              
              
              <li >
                <a href="/0.2.x"
                    
                >
                  0.2.x
                  
                </a>
              </li>
              
            </ul>
          </div>
          <div class="dropdown" id="searchBar">
            <div id="getkong-algolia-search" class="search-input v2 small">
              <img class="icon" src="/assets/images/icons/icn-magnifying-glass.svg" alt="search">
              <input type="text" placeholder="Type to search " id="getkong-algolia-search-input" />
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <aside class="docs-sidebar">
  <i class="fa fa-times close-sidebar"></i>
  

  <ul class="accordion-container">
    
    





<li class="accordion-item">
  
  <input id="accordion-1" type="checkbox" />
  
  
  <label for="accordion-1">
    
    
    Getting Started
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/getting-started/introduction"  >
      Introduction
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/getting-started/quickstart"  >
      Five-minute quickstart
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/getting-started/configuring-a-service"  >
      Configuring a Service
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/getting-started/enabling-plugins"  >
      Enabling Plugins
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/getting-started/adding-consumers"  >
      Adding Consumers
    </a>
  </li>
  
  
</ul>

  </div>
</li>


    
    





<li class="accordion-item">
  
  <input id="accordion-2" type="checkbox" />
  
  
  <label for="accordion-2">
    
    
    Guides &amp; References
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/configuration"  >
      Configuration reference
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/cli"  >
      CLI reference
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/proxy"  class="active">
      Proxy reference
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/auth"  >
      Authentication reference
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/loadbalancing"  >
      Load balancing reference
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/health-checks-circuit-breakers"  >
      Health checks and circuit breakers reference
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/clustering"  >
      Clustering reference
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/logging"  >
      Logging reference
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/network"  >
      Network &amp; Firewall
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/secure-admin-api"  >
      Securing the Admin API
    </a>
  </li>
  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-2-11" type="checkbox" />
  
  
  <label for="accordion-2-11">
    
    
    <a href="/1.1.x/plugin-development/">Plugin Development Guide</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/plugin-development"  >
      Introduction
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/plugin-development/file-structure"  >
      File structure
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/plugin-development/custom-logic"  >
      Implementing custom logic
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/plugin-development/plugin-configuration"  >
      Plugin configuration
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/plugin-development/access-the-datastore"  >
      Accessing the datastore
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/plugin-development/custom-entities"  >
      Storing custom entities
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/plugin-development/entities-cache"  >
      Caching custom entities
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/plugin-development/admin-api"  >
      Extending the Admin API
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/plugin-development/tests"  >
      Writing tests
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/plugin-development/distribution"  >
      (un)Installing your plugin
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-2-12" type="checkbox" />
  
  
  <label for="accordion-2-12">
    
    
    <a href="/1.1.x/pdk/">Plugin Development Kit</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.client"  >
      kong.client
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.ctx"  >
      kong.ctx
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.ip"  >
      kong.ip
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.log"  >
      kong.log
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.node"  >
      kong.node
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.request"  >
      kong.request
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.response"  >
      kong.response
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.router"  >
      kong.router
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.service"  >
      kong.service
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.service.request"  >
      kong.service.request
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.service.response"  >
      kong.service.response
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/pdk/kong.table"  >
      kong.table
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
</ul>

  </div>
</li>


    
    





<li class="accordion-item">
  
  <input id="accordion-3" type="checkbox" />
  
  
  <label for="accordion-3">
    
    
    <a href="/1.1.x/admin-api/">Admin API</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/db-less-admin-api"  >
      DB-less
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/db-less-admin-api/#declarative-configuration"  >
      Declarative Configuration
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#supported-content-types"  >
      Supported Content Types
    </a>
  </li>
  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-3-4" type="checkbox" />
  
  
  <label for="accordion-3-4">
    
    
    <a href="/1.1.x/admin-api/#information-routes/">Information routes</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-node-information"  >
      Retrieve node information
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-node-status"  >
      Retrieve node status
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-3-5" type="checkbox" />
  
  
  <label for="accordion-3-5">
    
    
    <a href="/1.1.x/admin-api/#service-object/">Service Object</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#add-service"  >
      Add Service
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-service"  >
      Retrieve Service
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#list-services"  >
      List Services
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-service"  >
      Update Service
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-or-create-service"  >
      Update or create Service
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#delete-service"  >
      Delete Service
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-3-6" type="checkbox" />
  
  
  <label for="accordion-3-6">
    
    
    <a href="/1.1.x/admin-api/#route-object/">Route Object</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#add-route"  >
      Add Route
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-route"  >
      Retrieve Route
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#list-routes"  >
      List Routes
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#list-routes-associated-to-a-service"  >
      List Routes associated to a Service
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-route"  >
      Update Route
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-or-create-route"  >
      Update or create Route
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#delete-route"  >
      Delete Route
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-3-7" type="checkbox" />
  
  
  <label for="accordion-3-7">
    
    
    <a href="/1.1.x/admin-api/#consumer-object/">Consumer Object routes</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#create-consumer"  >
      Create Consumer
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-consumer"  >
      Retrieve Consumer
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#list-consumers"  >
      List Consumers
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-consumer"  >
      Update Consumer
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-or-create-consumer"  >
      Update or create Consumer
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#delete-consumer"  >
      Delete Consumer
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-3-8" type="checkbox" />
  
  
  <label for="accordion-3-8">
    
    
    <a href="/1.1.x/admin-api/#plugin-object/">Plugin Object routes</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#add-plugin"  >
      Add Plugin
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-plugin"  >
      Retrieve Plugin
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#list-all-plugins"  >
      List all Plugins
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-plugin"  >
      Update Plugin
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-or-add-plugin"  >
      Update or Add Plugin
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#delete-plugin"  >
      Delete Plugin
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-enabled-plugins"  >
      Retrieve Enabled Plugins
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-plugin-schema"  >
      Retrieve Plugin Schema
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-3-9" type="checkbox" />
  
  
  <label for="accordion-3-9">
    
    
    <a href="/1.1.x/admin-api/#certificate-object/">Certificate Object routes</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#add-certificate"  >
      Add Certificate
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-certificate"  >
      Retrieve Certificate
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#list-certificates"  >
      List Certificates
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-certificate"  >
      Update Certificate
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-or-create-certificate"  >
      Update or Create Certificate
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#delete-certificate"  >
      Delete Certificate
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-3-10" type="checkbox" />
  
  
  <label for="accordion-3-10">
    
    
    <a href="/1.1.x/admin-api/#sni-objects/">SNI Object routes</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#add-sni"  >
      Add SNI
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-sni"  >
      Retrieve SNI
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#list-snis"  >
      List SNIs
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-sni"  >
      Update SNI
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-or-create-sni"  >
      Update or Create SNI
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#delete-sni"  >
      Delete SNI
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-3-11" type="checkbox" />
  
  
  <label for="accordion-3-11">
    
    
    <a href="/1.1.x/admin-api/#upstream-objects/">Upstream Object routes</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#add-upstream"  >
      Add Upstream
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#retrieve-upstream"  >
      Retrieve Upstream
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#list-upstreams"  >
      List all Upstreams
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-upstream"  >
      Update Upstream
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#update-or-create-upstream"  >
      Update or create Upstream
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#delete-upstream"  >
      Delete Upstream
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#show-upstream-health-for-node"  >
      Show Upstream health for node
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
  
  
  





<li class="accordion-item">
  
  <input id="accordion-3-12" type="checkbox" />
  
  
  <label for="accordion-3-12">
    
    
    <a href="/1.1.x/admin-api/#target-object/">Target Object routes</a>
    
    
    <i class="fa fa-chevron-down"></i>
    
  </label>
  
  <div>
    
<ul class="items">
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#add-target"  >
      Add Target
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#list-targets"  >
      List Targets
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#list-all-targets"  >
      List All Targets
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#delete-target"  >
      Delete Target
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#set-target-as-healthy"  >
      Set Target as Healthy
    </a>
  </li>
  
  
  
  
  
  
  <li>
    <a href="/1.1.x/admin-api/#set-target-as-unhealthy"  >
      Set Target as Unhealthy
    </a>
  </li>
  
  
</ul>

  </div>
</li>


  
  
</ul>

  </div>
</li>


    
  </ul>
</aside>


    
    <aside class="docs-toc">
      <i class="fa fa-times close-sidebar"></i>
      <i class="fa fa-chevron-right collapse-toc"></i>
      <i class="far fa-list-alt expand-toc"></i>
      <div class="docs-toc-title">On this page</div>
      <ul>
  <li><a href="#introduction" class="active scroll-to">Introduction</a></li>
  <li><a href="#terminology" class="scroll-to">Terminology</a></li>
  <li><a href="#overview" class="scroll-to">Overview</a></li>
  <li><a href="#reminder-how-to-configure-a-service" class="scroll-to">Reminder: How to configure a Service</a></li>
  <li><a href="#routes-and-matching-capabilities" class="scroll-to">Routes and matching capabilities</a>
    <ul>
      <li><a href="#request-host-header" class="scroll-to">Request Host header</a></li>
      <li><a href="#request-path" class="scroll-to">Request path</a></li>
      <li><a href="#request-http-method" class="scroll-to">Request HTTP method</a></li>
    </ul>
  </li>
  <li><a href="#matching-priorities" class="scroll-to">Matching priorities</a></li>
  <li><a href="#proxying-behavior" class="scroll-to">Proxying behavior</a>
    <ul>
      <li><a href="#1-load-balancing" class="scroll-to">1. Load balancing</a></li>
      <li><a href="#2-plugins-execution" class="scroll-to">2. Plugins execution</a></li>
      <li><a href="#3-proxying--upstream-timeouts" class="scroll-to">3. Proxying &amp; upstream timeouts</a></li>
      <li><a href="#4-errors--retries" class="scroll-to">4. Errors &amp; retries</a></li>
      <li><a href="#5-response" class="scroll-to">5. Response</a></li>
    </ul>
  </li>
  <li><a href="#configuring-a-fallback-route" class="scroll-to">Configuring a fallback Route</a></li>
  <li><a href="#configuring-ssl-for-a-route" class="scroll-to">Configuring SSL for a Route</a>
    <ul>
      <li><a href="#restricting-the-client-protocol-httphttpstcptls" class="scroll-to">Restricting the client protocol (HTTP/HTTPS/TCP/TLS)</a></li>
    </ul>
  </li>
  <li><a href="#proxy-websocket-traffic" class="scroll-to">Proxy WebSocket traffic</a>
    <ul>
      <li><a href="#websocket-and-tls" class="scroll-to">WebSocket and TLS</a></li>
    </ul>
  </li>
  <li><a href="#conclusion" class="scroll-to">Conclusion</a></li>
</ul>

    </aside>
    

    <div class="page-content-container v2" id="documentation">
      <div class="toggles">
        <i class="fas fa-stream sidebar-toggle"></i>
        
        <i class="far fa-list-alt toc-sidebar-toggle"></i>
        
      </div>

      <div class="page-content">
        <div class="content show-anchor-links">
          
          <div class="alert alert-ee">
            Maybe you were looking for the <a href="/enterprise"><strong>Enterprise Documentation</strong></a>
            instead?
          </div>
          
          
          <div class="alert alert-warning">
            <strong>Careful!</strong> You are browsing documentation for an outdated version of Kong Kong Gateway. Go <a
                  href="/latest">here</a>
            to browse the documentation for the latest version.
          </div>
          

          
          <span class="reading-time" title="Estimated reading time">
  Estimated reading time:
  
  
    32 minutes
  
</span>

          

          <h2 id="introduction">Introduction</h2>

<p>In this document we will cover Kongâ€™s <strong>proxying capabilities</strong>  by explaining
its routing capabilities and internal workings in details.</p>

<p>Kong exposes several interfaces which can be tweaked by two configuration
properties:</p>

<ul>
  <li><code class="highlighter-rouge">proxy_listen</code>, which defines a list of addresses/ports on which Kong will
accept <strong>public traffic</strong> from clients and proxy it to your upstream services
(<code class="highlighter-rouge">8000</code> by default).</li>
  <li><code class="highlighter-rouge">admin_listen</code>, which also defines a list of addresses and ports, but those
should be restricted to only be accessed by administrators, as they expose
Kongâ€™s configuration capabilities: the <strong>Admin API</strong> (<code class="highlighter-rouge">8001</code> by default).</li>
</ul>

<div class="alert alert-warning">
<p><strong>Note:</strong> Starting with 1.0.0, the API entity has been removed.
This document will cover proxying with the new Routes and
Services entities.</p>
<p>See an older version of this document if you are using 0.12 or
below.</p>
</div>

<h2 id="terminology">Terminology</h2>

<ul>
  <li><code class="highlighter-rouge">client</code>: Refers to the <em>downstream</em> client making requests to Kongâ€™s
proxy port.</li>
  <li><code class="highlighter-rouge">upstream service</code>: Refers to your own API/service sitting behind Kong, to
which client requests are forwarded.</li>
  <li><code class="highlighter-rouge">Service</code>: Service entities, as the name implies, are abstractions of each of
your own upstream services. Examples of Services would be a data
transformation microservice, a billing API, etc.</li>
  <li><code class="highlighter-rouge">Route</code>: This refers to the Kong Routes entity. Routes are entrypoints into
Kong, and defining rules for a request to be matched, and routed to a given
Service.</li>
  <li><code class="highlighter-rouge">Plugin</code>: This refers to Kong â€œpluginsâ€, which are pieces of business logic
that run in the proxying lifecycle. Plugins can be configured through the
Admin API - either globally (all incoming traffic) or on specific Routes
and Services.</li>
</ul>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="overview">Overview</h2>

<p>From a high-level perspective, Kong listens for HTTP traffic on its configured
proxy port(s) (<code class="highlighter-rouge">8000</code> and <code class="highlighter-rouge">8443</code> by default). Kong will evaluate any incoming
HTTP request against the Routes you have configured and try to find a matching
one. If a given request matches the rules of a specific Route, Kong will
process proxying the request. Because each Route is linked to a Service, Kong
will run the plugins you have configured on your Route and its associated
Service, and then proxy the request upstream.</p>

<p>You can manage Routes via Kongâ€™s Admin API. The <code class="highlighter-rouge">hosts</code>, <code class="highlighter-rouge">paths</code>, and <code class="highlighter-rouge">methods</code>
attributes of Routes define rules for matching incoming HTTP requests.</p>

<p>If Kong receives a request that it cannot match against any of the configured
Routes (or if no Routes are configured), it will respond with:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">404</span> <span class="ne">Not Found</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">kong/&lt;x.x.x&gt;</span>

<span class="p">{</span><span class="w">
    </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no route and no Service found with those values"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="reminder-how-to-configure-a-service">Reminder: How to configure a Service</h2>

<p>The <a href="/1.1.x/getting-started/configuring-a-service">Configuring a Service</a> quickstart guide explains
how Kong is configured via the <a href="/1.1.x/admin-api">Admin API</a>.</p>

<p>Adding a Service to Kong is done by sending an HTTP request to the Admin API:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/services/ <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'name=foo-service'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'url=http://foo-service.com'</span>
HTTP/1.1 201 Created
...

<span class="o">{</span>
    <span class="s2">"connect_timeout"</span>: 60000,
    <span class="s2">"created_at"</span>: 1515537771,
    <span class="s2">"host"</span>: <span class="s2">"foo-service.com"</span>,
    <span class="s2">"id"</span>: <span class="s2">"d54da06c-d69f-4910-8896-915c63c270cd"</span>,
    <span class="s2">"name"</span>: <span class="s2">"foo-service"</span>,
    <span class="s2">"path"</span>: <span class="s2">"/"</span>,
    <span class="s2">"port"</span>: 80,
    <span class="s2">"protocol"</span>: <span class="s2">"http"</span>,
    <span class="s2">"read_timeout"</span>: 60000,
    <span class="s2">"retries"</span>: 5,
    <span class="s2">"updated_at"</span>: 1515537771,
    <span class="s2">"write_timeout"</span>: 60000
<span class="o">}</span>
</code></pre></div></div>

<p>This request instructs Kong to register a Service named â€œfoo-serviceâ€, which
points to <code class="highlighter-rouge">http://foo-service.com</code> (your upstream).</p>

<p><strong>Note:</strong> the <code class="highlighter-rouge">url</code> argument is a shorthand argument to populate the
<code class="highlighter-rouge">protocol</code>, <code class="highlighter-rouge">host</code>, <code class="highlighter-rouge">port</code>, and <code class="highlighter-rouge">path</code> attributes at once.</p>

<p>Now, in order to send traffic to this Service through Kong, we need to specify
a Route, which acts as an entrypoint to Kong:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/routes/ <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'hosts[]=example.com'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'paths[]=/foo'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'service.id=d54da06c-d69f-4910-8896-915c63c270cd'</span>
HTTP/1.1 201 Created
...

<span class="o">{</span>
    <span class="s2">"created_at"</span>: 1515539858,
    <span class="s2">"hosts"</span>: <span class="o">[</span>
        <span class="s2">"example.com"</span>
    <span class="o">]</span>,
    <span class="s2">"id"</span>: <span class="s2">"ee794195-6783-4056-a5cc-a7e0fde88c81"</span>,
    <span class="s2">"methods"</span>: null,
    <span class="s2">"paths"</span>: <span class="o">[</span>
        <span class="s2">"/foo"</span>
    <span class="o">]</span>,
    <span class="s2">"preserve_host"</span>: <span class="nb">false</span>,
    <span class="s2">"priority"</span>: 0,
    <span class="s2">"protocols"</span>: <span class="o">[</span>
        <span class="s2">"http"</span>,
        <span class="s2">"https"</span>
    <span class="o">]</span>,
    <span class="s2">"service"</span>: <span class="o">{</span>
        <span class="s2">"id"</span>: <span class="s2">"d54da06c-d69f-4910-8896-915c63c270cd"</span>
    <span class="o">}</span>,
    <span class="s2">"strip_path"</span>: <span class="nb">true</span>,
    <span class="s2">"updated_at"</span>: 1515539858
<span class="o">}</span>
</code></pre></div></div>

<p>We have now configured a Route to match incoming requests matching the given
<code class="highlighter-rouge">hosts</code> and <code class="highlighter-rouge">paths</code>, and forward them to the <code class="highlighter-rouge">foo-service</code> we configured, thus
proxying this traffic to <code class="highlighter-rouge">http://foo-service.com</code>.</p>

<p>Kong is a transparent proxy, and it will by default forward the request to your
upstream service untouched, with the exception of various headers such as
<code class="highlighter-rouge">Connection</code>, <code class="highlighter-rouge">Date</code>, and others as required by the HTTP specifications.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="routes-and-matching-capabilities">Routes and matching capabilities</h2>

<p>Letâ€™s now discuss how Kong matches a request against the configured <code class="highlighter-rouge">hosts</code>,
<code class="highlighter-rouge">paths</code> and <code class="highlighter-rouge">methods</code> properties (or fields) of a Route. Note that all three of
these fields are <strong>optional</strong>, but at least <strong>one of them</strong> must be specified.</p>

<p>For a request to match a Route:</p>

<ul>
  <li>The request <strong>must</strong> include <strong>all</strong> of the configured fields</li>
  <li>The values of the fields in the request <strong>must</strong> match at least one of the
configured values (While the field configurations accepts one or more values,
a request needs only one of the values to be considered a match)</li>
</ul>

<p>Letâ€™s go through a few examples. Consider a Route configured like this:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"example.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"foo-service.com"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/foo"</span><span class="p">,</span><span class="w"> </span><span class="s2">"/bar"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"GET"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Some of the possible requests matching this Route would look like:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/foo</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/bar</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">foo-service.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/foo/hello/world</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<p>All three of these requests satisfy all the conditions set in the Route
definition.</p>

<p>However, the following requests would <strong>not</strong> match the configured conditions:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/foo</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/foo</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">foo.com</span>
</code></pre></div></div>

<p>All three of these requests satisfy only two of configured conditions. The
first requestâ€™s path is not a match for any of the configured <code class="highlighter-rouge">paths</code>, same for
the second requestâ€™s HTTP method, and the third requestâ€™s Host header.</p>

<p>Now that we understand how the <code class="highlighter-rouge">hosts</code>, <code class="highlighter-rouge">paths</code>, and <code class="highlighter-rouge">methods</code> properties work
together, letâ€™s explore each property individually.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="request-host-header">Request Host header</h3>

<p>Routing a request based on its Host header is the most straightforward way to
proxy traffic through Kong, especially since this is the intended usage of the
HTTP Host header. Kong makes it easy to do via the <code class="highlighter-rouge">hosts</code> field of the Route
entity.</p>

<p><code class="highlighter-rouge">hosts</code> accepts multiple values, which must be comma-separated when specifying
them via the Admin API:</p>

<p><code class="highlighter-rouge">hosts</code> accepts multiple values, which is straightforward to represent in a
JSON payload:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/routes/ <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{"hosts":["example.com", "foo-service.com"]}'</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>But since the Admin API also supports form-urlencoded content types, you
can specify an array via the <code class="highlighter-rouge">[]</code> notation:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/routes/ <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'hosts[]=example.com'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'hosts[]=foo-service.com'</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>To satisfy the <code class="highlighter-rouge">hosts</code> condition of this Route, any incoming request from a
client must now have its Host header set to one of:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Host: example.com
</code></pre></div></div>

<p>or:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Host: foo-service.com
</code></pre></div></div>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h4 id="using-wildcard-hostnames">Using wildcard hostnames</h4>

<p>To provide flexibility, Kong allows you to specify hostnames with wildcards in
the <code class="highlighter-rouge">hosts</code> field. Wildcard hostnames allow any matching Host header to satisfy
the condition, and thus match a given Route.</p>

<p>Wildcard hostnames <strong>must</strong> contain <strong>only one</strong> asterisk at the leftmost
<strong>or</strong> rightmost label of the domain. Examples:</p>

<ul>
  <li><code class="highlighter-rouge">*.example.com</code> would allow Host values such as <code class="highlighter-rouge">a.example.com</code> and
<code class="highlighter-rouge">x.y.example.com</code> to match.</li>
  <li><code class="highlighter-rouge">example.*</code> would allow Host values such as <code class="highlighter-rouge">example.com</code> and <code class="highlighter-rouge">example.org</code>
to match.</li>
</ul>

<p>A complete example would look like this:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"*.example.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"service.com"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Which would allow the following requests to match this Route:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">an.example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">service.com</span>
</code></pre></div></div>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h4 id="the-preserve_host-property">The <code class="highlighter-rouge">preserve_host</code> property</h4>

<p>When proxying, Kongâ€™s default behavior is to set the upstream requestâ€™s Host
header to the hostname specified in the Serviceâ€™s <code class="highlighter-rouge">host</code>. The
<code class="highlighter-rouge">preserve_host</code> field accepts a boolean flag instructing Kong not to do so.</p>

<p>For example, when the <code class="highlighter-rouge">preserve_host</code> property is not changed and a Route is
configured like so:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"service.com"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>A possible request from a client to Kong could be:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">service.com</span>
</code></pre></div></div>

<p>Kong would extract the Host header value from the Serviceâ€™s <code class="highlighter-rouge">host</code> property, ,
and would send the following upstream request:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">&lt;my-service-host.com&gt;</span>
</code></pre></div></div>

<p>However, by explicitly configuring a Route with <code class="highlighter-rouge">preserve_host=true</code>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"service.com"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"preserve_host"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>And assuming the same request from the client:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">service.com</span>
</code></pre></div></div>

<p>Kong would preserve the Host on the client request and would send the following
upstream request instead:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">service.com</span>
</code></pre></div></div>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="request-path">Request path</h3>

<p>Another way for a Route to be matched is via request paths. To satisfy this
routing condition, a client requestâ€™s path <strong>must</strong> be prefixed with one of the
values of the <code class="highlighter-rouge">paths</code> attribute.</p>

<p>For example, with a Route configured like so:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/service"</span><span class="p">,</span><span class="w"> </span><span class="s2">"/hello/world"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The following requests would be matched:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/service</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/service/resource?param=value</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/hello/world/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">anything.com</span>
</code></pre></div></div>

<p>For each of these requests, Kong detects that their URL path is prefixed with
one of the Routesâ€™s <code class="highlighter-rouge">paths</code> values. By default, Kong would then proxy the
request upstream without changing the URL path.</p>

<p>When proxying with path prefixes, <strong>the longest paths get evaluated first</strong>.
This allow you to define two Routes with two paths: <code class="highlighter-rouge">/service</code> and
<code class="highlighter-rouge">/service/resource</code>, and ensure that the former does not â€œshadowâ€ the latter.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h4 id="using-regexes-in-paths">Using regexes in paths</h4>

<p>Kong supports regular expression pattern matching for an Routeâ€™s <code class="highlighter-rouge">paths</code> field
via <a href="http://pcre.org/">PCRE</a> (Perl Compatible Regular Expression). You can
assign paths as both prefixes and regexes to a Route at the same time.</p>

<p>For example, if we consider the following Route:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/users/</span><span class="se">\d</span><span class="s2">+/profile"</span><span class="p">,</span><span class="w"> </span><span class="s2">"/following"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The following requests would be matched by this Route:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/following</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/users/123/profile</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p>The provided regexes are evaluated with the <code class="highlighter-rouge">a</code> PCRE flag (<code class="highlighter-rouge">PCRE_ANCHORED</code>),
meaning that they will be constrained to match at the first matching point
in the path (the root <code class="highlighter-rouge">/</code> character).</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h5 id="evaluation-order">Evaluation order</h5>

<p>As previously mentioned, Kong evaluates prefix paths by length: the longest
prefix paths are evaluated first. However, Kong will evaluate regex paths based
on the <code class="highlighter-rouge">regex_priority</code> attribute of Routes from highest priority to lowest.
This means that considering the following Routes:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/status/</span><span class="se">\d</span><span class="s2">+"</span><span class="p">],</span><span class="w">
        </span><span class="nl">"regex_priority"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/version/</span><span class="se">\d</span><span class="s2">+/status/</span><span class="se">\d</span><span class="s2">+"</span><span class="p">],</span><span class="w">
        </span><span class="nl">"regex_priority"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/version"</span><span class="p">],</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/version/any/"</span><span class="p">],</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>In this scenario, Kong will evaluate incoming requests against the following
defined URIs, in this order:</p>

<ol>
  <li><code class="highlighter-rouge">/version/any/</code></li>
  <li><code class="highlighter-rouge">/version</code></li>
  <li><code class="highlighter-rouge">/version/\d+/status/\d+</code></li>
  <li><code class="highlighter-rouge">/status/\d+</code></li>
</ol>

<p>Prefix paths are always evaluated before regex paths.</p>

<p>As usual, a request must still match a Routeâ€™s <code class="highlighter-rouge">hosts</code> and <code class="highlighter-rouge">methods</code> properties
as well, and Kong will traverse your Routes until it finds one that matches
the most rules (see [Routing priorities][proxy-routing-priorities]).</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h5 id="capturing-groups">Capturing groups</h5>

<p>Capturing groups are also supported, and the matched group will be extracted
from the path and available for plugins consumption. If we consider the
following regex:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/version/(?&lt;version&gt;\d+)/users/(?&lt;user&gt;\S+)
</code></pre></div></div>

<p>And the following request path:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/version/1/users/john
</code></pre></div></div>

<p>Kong will consider the request path a match, and if the overall Route is
matched (considering the <code class="highlighter-rouge">hosts</code> and <code class="highlighter-rouge">methods</code> fields), the extracted capturing
groups will be available from the plugins in the <code class="highlighter-rouge">ngx.ctx</code> variable:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">router_matches</span> <span class="o">=</span> <span class="n">ngx</span><span class="p">.</span><span class="n">ctx</span><span class="p">.</span><span class="n">router_matches</span>

<span class="c1">-- router_matches.uri_captures is:</span>
<span class="c1">-- { "1", "john", version = "1", user = "john" }</span>
</code></pre></div></div>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h5 id="escaping-special-characters">Escaping special characters</h5>

<p>Next, it is worth noting that characters found in regexes are often
reserved characters according to
<a href="https://tools.ietf.org/html/rfc3986">RFC 3986</a> and as such,
should be percent-encoded. <strong>When configuring Routes with regex paths via the
Admin API, be sure to URL encode your payload if necessary</strong>. For example,
with <code class="highlighter-rouge">curl</code> and using an <code class="highlighter-rouge">application/x-www-form-urlencoded</code> MIME type:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/routes <span class="se">\</span>
    <span class="nt">--data-urlencode</span> <span class="s1">'uris[]=/status/\d+'</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>Note that <code class="highlighter-rouge">curl</code> does not automatically URL encode your payload, and note the
usage of <code class="highlighter-rouge">--data-urlencode</code>, which prevents the <code class="highlighter-rouge">+</code> character to be URL decoded
and interpreted as a space ` ` by Kongâ€™s Admin API.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h4 id="the-strip_path-property">The <code class="highlighter-rouge">strip_path</code> property</h4>

<p>It may be desirable to specify a path prefix to match a Route, but not
include it in the upstream request. To do so, use the <code class="highlighter-rouge">strip_path</code> boolean
property by configuring a Route like so:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/service"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"strip_path"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Enabling this flag instructs Kong that when matching this Route, and proceeding
with the proxying to a Service, it should <strong>not</strong> include the matched part of
the URL path in the upstream requestâ€™s URL. For example, the following
clientâ€™s request to the above Route:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/service/path/to/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p>Will cause Kong to send the following upstream request:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/path/to/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p>The same way, if a regex path is defined on a Route that has <code class="highlighter-rouge">strip_path</code>
enabled, the entirety of the request URL matching sequence will be stripped.
Example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/version/</span><span class="se">\d</span><span class="s2">+/service"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"strip_path"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The following HTTP request matching the provided regex path:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/version/1/service/path/to/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p>Will be proxied upstream by Kong as:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/path/to/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="request-http-method">Request HTTP method</h3>

<p>The <code class="highlighter-rouge">methods</code> field allows matching the requests depending on their HTTP
method.  It accepts multiple values. Its default value is empty (the HTTP
method is not used for routing).</p>

<p>The following Route allows routing via <code class="highlighter-rouge">GET</code> and <code class="highlighter-rouge">HEAD</code>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"GET"</span><span class="p">,</span><span class="w"> </span><span class="s2">"HEAD"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Such a Route would be matched with the following requests:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">HEAD</span> <span class="nn">/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p>But it would not match a <code class="highlighter-rouge">POST</code> or <code class="highlighter-rouge">DELETE</code> request. This allows for much more
granularity when configuring plugins on Routes. For example, one could imagine
two Routes pointing to the same service: one with unlimited unauthenticated
<code class="highlighter-rouge">GET</code> requests, and a second one allowing only authenticated and rate-limited
<code class="highlighter-rouge">POST</code> requests (by applying the authentication and rate limiting plugins to
such requests).</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="matching-priorities">Matching priorities</h2>

<p>A Route may define matching rules based on its <code class="highlighter-rouge">hosts</code>, <code class="highlighter-rouge">paths</code>, and <code class="highlighter-rouge">methods</code>
fields. For Kong to match an incoming request to a Route, all existing fields
must be satisfied. However, Kong allows for quite some flexibility by allowing
two or more Routes to be configured with fields containing the same values -
when this occurs, Kong applies a priority rule.</p>

<p>The rule is: <strong>when evaluating a request, Kong will first try to match the
Routes with the most rules</strong>.</p>

<p>For example, if two Routes are configured like so:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"example.com"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"example.com"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"POST"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The second Route has a <code class="highlighter-rouge">hosts</code> field <strong>and</strong> a <code class="highlighter-rouge">methods</code> field, so it will be
evaluated first by Kong. By doing so, we avoid the first Route â€œshadowingâ€
calls intended for the second one.</p>

<p>Thus, this request will match the first Route</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<p>And this request will match the second one:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<p>Following this logic, if a third Route was to be configured with a <code class="highlighter-rouge">hosts</code>
field, a <code class="highlighter-rouge">methods</code> field, and a <code class="highlighter-rouge">uris</code> field, it would be evaluated first by
Kong.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="proxying-behavior">Proxying behavior</h2>

<p>The proxying rules above detail how Kong forwards incoming requests to your
upstream services. Below, we detail what happens internally between the time
Kong <em>matches</em> an HTTP request with a registered Route, and the actual
<em>forwarding</em> of the request.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="1-load-balancing">1. Load balancing</h3>

<p>Kong implements load balancing capabilities to distribute proxied
requests across a pool of instances of an upstream service.</p>

<p>You can find more information about configuring load balancing by consulting
the <a href="/1.1.x/loadbalancing">Load Balancing Reference</a>.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="2-plugins-execution">2. Plugins execution</h3>

<p>Kong is extensible via â€œpluginsâ€ that hook themselves in the request/response
lifecycle of the proxied requests. Plugins can perform a variety of operations
in your environment and/or transformations on the proxied request.</p>

<p>Plugins can be configured to run globally (for all proxied traffic) or on
specific Routes and Services. In both cases, you must create a <a href="/1.1.x/admin-api#plugin-object">plugin
configuration</a> via the Admin API.</p>

<p>Once a Route has been matched (and its associated Service entity), Kong will
run plugins associated to either of those entities. Plugins configured on a
Route run before plugins configured on a Service, but otherwise, the usual
rules of <a href="/1.1.x/admin-api/#precedence">plugins association</a> apply.</p>

<p>These configured plugins will run their <code class="highlighter-rouge">access</code> phase, which you can find more
information about in the <a href="/1.1.x/plugin-development">Plugin development guide</a>.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="3-proxying--upstream-timeouts">3. Proxying &amp; upstream timeouts</h3>

<p>Once Kong has executed all the necessary logic (including plugins), it is ready
to forward the request to your upstream service. This is done via Nginxâ€™s
<a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html">ngx_http_proxy_module</a>. You can configure the desired
timeouts for the connection between Kong and a given upstream, via the following
properties of a Service:</p>

<ul>
  <li><code class="highlighter-rouge">upstream_connect_timeout</code>: defines in milliseconds the timeout for
establishing a connection to your upstream service. Defaults to <code class="highlighter-rouge">60000</code>.</li>
  <li><code class="highlighter-rouge">upstream_send_timeout</code>: defines in milliseconds a timeout between two
successive write operations for transmitting a request to your upstream
service.  Defaults to <code class="highlighter-rouge">60000</code>.</li>
  <li><code class="highlighter-rouge">upstream_read_timeout</code>: defines in milliseconds a timeout between two
successive read operations for receiving a request from your upstream
service.  Defaults to <code class="highlighter-rouge">60000</code>.</li>
</ul>

<p>Kong will send the request over HTTP/1.1, and set the following headers:</p>

<ul>
  <li><code class="highlighter-rouge">Host: &lt;your_upstream_host&gt;</code>, as previously described in this document.</li>
  <li><code class="highlighter-rouge">Connection: keep-alive</code>, to allow for reusing the upstream connections.</li>
  <li><code class="highlighter-rouge">X-Real-IP: &lt;remote_addr&gt;</code>, where <code class="highlighter-rouge">$remote_addr</code> is the variable bearing
the same name provided by
<a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_remote_addr">ngx_http_core_module</a>. Please note that the
<code class="highlighter-rouge">$remote_addr</code> is likely overridden by
<a href="http://nginx.org/en/docs/http/ngx_http_realip_module.html">ngx_http_realip_module</a>.</li>
  <li><code class="highlighter-rouge">X-Forwarded-For: &lt;address&gt;</code>, where <code class="highlighter-rouge">&lt;address&gt;</code> is the content of
<code class="highlighter-rouge">$realip_remote_addr</code> provided by
<a href="http://nginx.org/en/docs/http/ngx_http_realip_module.html">ngx_http_realip_module</a> appended to the request
header with the same name.</li>
  <li><code class="highlighter-rouge">X-Forwarded-Proto: &lt;protocol&gt;</code>, where <code class="highlighter-rouge">&lt;protocol&gt;</code> is the protocol used by
the client. In the case where <code class="highlighter-rouge">$realip_remote_addr</code> is one of the <strong>trusted</strong>
addresses, the request header with the same name gets forwarded if provided.
Otherwise, the value of the <code class="highlighter-rouge">$scheme</code> variable provided by
<a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_scheme">ngx_http_core_module</a> will be used.</li>
  <li><code class="highlighter-rouge">X-Forwarded-Host: &lt;host&gt;</code>, where <code class="highlighter-rouge">&lt;host&gt;</code> is the host name sent by
the client. In the case where <code class="highlighter-rouge">$realip_remote_addr</code> is one of the <strong>trusted</strong>
addresses, the request header with the same name gets forwarded if provided.
Otherwise, the value of the <code class="highlighter-rouge">$host</code> variable provided by
<a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_host">ngx_http_core_module</a> will be used.</li>
  <li><code class="highlighter-rouge">X-Forwarded-Port: &lt;port&gt;</code>, where <code class="highlighter-rouge">&lt;port&gt;</code> is the port of the server which
accepted a request. In the case where <code class="highlighter-rouge">$realip_remote_addr</code> is one of the
<strong>trusted</strong> addresses, the request header with the same name gets forwarded
if provided. Otherwise, the value of the <code class="highlighter-rouge">$server_port</code> variable provided by
<a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_server_port">ngx_http_core_module</a> will be used.</li>
</ul>

<p>All the other request headers are forwarded as-is by Kong.</p>

<p>One exception to this is made when using the WebSocket protocol. If so, Kong
will set the following headers to allow for upgrading the protocol between the
client and your upstream services:</p>

<ul>
  <li><code class="highlighter-rouge">Connection: Upgrade</code></li>
  <li><code class="highlighter-rouge">Upgrade: websocket</code></li>
</ul>

<p>More information on this topic is covered in the
[Proxy WebSocket traffic][proxy-websocket] section.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="4-errors--retries">4. Errors &amp; retries</h3>

<p>Whenever an error occurs during proxying, Kong will use the underlying
Nginx <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_next_upstream_tries">retries</a> mechanism to pass the request on to
the next upstream.</p>

<p>There are two configurable elements here:</p>

<ol>
  <li>
    <p>The number of retries: this can be configured per Service using the
<code class="highlighter-rouge">retries</code> property. See the <a href="/1.1.x/admin-api">Admin API</a> for more details on this.</p>
  </li>
  <li>
    <p>What exactly constitutes an error: here Kong uses the Nginx defaults, which
means an error or timeout occurring while establishing a connection with the
server, passing a request to it, or reading the response headers.</p>
  </li>
</ol>

<p>The second option is based on Nginxâ€™s
[proxy_next_upstream][proxy_next_upstream] directive. This option is not
directly configurable through Kong, but can be added using a custom Nginx
configuration. See the <a href="/1.1.x/configuration/">configuration reference</a> for
more details.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="5-response">5. Response</h3>

<p>Kong receives the response from the upstream service and sends it back to the
downstream client in a streaming fashion. At this point Kong will execute
subsequent plugins added to the Route and/or Service that implement a hook in
the <code class="highlighter-rouge">header_filter</code> phase.</p>

<p>Once the <code class="highlighter-rouge">header_filter</code> phase of all registered plugins has been executed, the
following headers will be added by Kong and the full set of headers be sent to
the client:</p>

<ul>
  <li><code class="highlighter-rouge">Via: kong/x.x.x</code>, where <code class="highlighter-rouge">x.x.x</code> is the Kong version in use</li>
  <li><code class="highlighter-rouge">X-Kong-Proxy-Latency: &lt;latency&gt;</code>, where <code class="highlighter-rouge">latency</code> is the time in milliseconds
between Kong receiving the request from the client and sending the request to
your upstream service.</li>
  <li><code class="highlighter-rouge">X-Kong-Upstream-Latency: &lt;latency&gt;</code>, where <code class="highlighter-rouge">latency</code> is the time in
milliseconds that Kong was waiting for the first byte of the upstream service
response.</li>
</ul>

<p>Once the headers are sent to the client, Kong will start executing
registered plugins for the Route and/or Service that implement the
<code class="highlighter-rouge">body_filter</code> hook. This hook may be called multiple times, due to the
streaming nature of Nginx. Each chunk of the upstream response that is
successfully processed by such <code class="highlighter-rouge">body_filter</code> hooks is sent back to the client.
You can find more information about the <code class="highlighter-rouge">body_filter</code> hook in the <a href="/1.1.x/plugin-development">Plugin
development guide</a>.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="configuring-a-fallback-route">Configuring a fallback Route</h2>

<p>As a practical use-case and example of the flexibility offered by Kongâ€™s
proxying capabilities, letâ€™s try to implement a â€œfallback Routeâ€, so that in
order to avoid Kong responding with an HTTP <code class="highlighter-rouge">404</code>, â€œno route foundâ€, we can
catch such requests and proxy them to a special upstream service, or apply a
plugin to it (such a plugin could, for example, terminate the request with a
different status code or response without proxying the request).</p>

<p>Here is an example of such a fallback Route:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>As you can guess, any HTTP request made to Kong would actually match this
Route, since all URIs are prefixed by the root character <code class="highlighter-rouge">/</code>. As we know from
the [Request path][proxy-request-path] section, the longest URL paths are
evaluated first by Kong, so the <code class="highlighter-rouge">/</code> path will eventually be evaluated last by
Kong, and effectively provide a â€œfallbackâ€ Route, only matched as a last
resort. You can then send traffic to a special Service or apply any plugin you
wish on this Route.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="configuring-ssl-for-a-route">Configuring SSL for a Route</h2>

<p>Kong provides a way to dynamically serve SSL certificates on a per-connection
basis. SSL certificates are directly handled by the core, and configurable via
the Admin API. Clients connecting to Kong over TLS must support the <a href="https://en.wikipedia.org/wiki/Server_Name_Indication">Server
Name Indication</a> extension to make use of this feature.</p>

<p>SSL certificates are handled by two resources in the Kong Admin API:</p>

<ul>
  <li><code class="highlighter-rouge">/certificates</code>, which stores your keys and certificates.</li>
  <li><code class="highlighter-rouge">/snis</code>, which associates a registered certificate with a Server Name
Indication.</li>
</ul>

<p>You can find the documentation for those two resources in the
<a href="/1.1.x/admin-api">Admin API Reference</a>.</p>

<p>Here is how to configure an SSL certificate on a given Route: first, upload
your SSL certificate and key via the Admin API:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/certificates <span class="se">\</span>
    <span class="nt">-F</span> <span class="s2">"cert=@/path/to/cert.pem"</span> <span class="se">\</span>
    <span class="nt">-F</span> <span class="s2">"key=@/path/to/cert.key"</span> <span class="se">\</span>
    <span class="nt">-F</span> <span class="s2">"snis=ssl-example.com,other-ssl-example.com"</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>The <code class="highlighter-rouge">snis</code> form parameter is a sugar parameter, directly inserting an SNI and
associating the uploaded certificate to it.</p>

<p>You must now register the following Route within Kong. We will match requests
to this Route using only the Host header for convenience:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/routes <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'hosts=ssl-example.com,other-ssl-example.com'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'service.id=d54da06c-d69f-4910-8896-915c63c270cd'</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>You can now expect the Route to be served over HTTPS by Kong:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> https://localhost:8443/ <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Host: ssl-example.com"</span>
HTTP/1.1 200 OK
...
</code></pre></div></div>

<p>When establishing the connection and negotiating the SSL handshake, if your
client sends <code class="highlighter-rouge">ssl-example.com</code> as part of the SNI extension, Kong will serve
the <code class="highlighter-rouge">cert.pem</code> certificate previously configured.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="restricting-the-client-protocol-httphttpstcptls">Restricting the client protocol (HTTP/HTTPS/TCP/TLS)</h3>

<p>Routes have a <code class="highlighter-rouge">protocols</code> property to restrict the client protocol they should
listen for. This attribute accepts a set of values, which can be <code class="highlighter-rouge">"http"</code>,
<code class="highlighter-rouge">"https"</code>, <code class="highlighter-rouge">"tcp"</code> or <code class="highlighter-rouge">"tls"</code>.</p>

<p>A Route with <code class="highlighter-rouge">http</code> and <code class="highlighter-rouge">https</code> will accept traffic in both protocols.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"protocols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"http"</span><span class="p">,</span><span class="w"> </span><span class="s2">"https"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Not specifying any protocol has the same effect, since routes default to
<code class="highlighter-rouge">["http", "https"]</code>.</p>

<p>However, a Route with <em>only</em> <code class="highlighter-rouge">https</code> would <em>only</em> accept traffic over HTTPS. It
would <em>also</em> accept unencrypted traffic <em>if</em> SSL termination previously
occurred from a trusted IP. SSL termination is considered valid when the
request comes from one of the configured IPs in
<a href="/1.1.x/configuration/#trusted_ips">trusted_ips</a> and if the <code class="highlighter-rouge">X-Forwarded-Proto: https</code>
header is set:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"protocols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"https"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>If a Route such as the above matches a request, but that request is in
plain-text without valid prior SSL termination, Kong responds with:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">426</span> <span class="ne">Upgrade Required</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8</span>
<span class="na">Transfer-Encoding</span><span class="p">:</span> <span class="s">chunked</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">Upgrade</span>
<span class="na">Upgrade</span><span class="p">:</span> <span class="s">TLS/1.2, HTTP/1.1</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">kong/x.y.z</span>

<span class="p">{</span><span class="nl">"message"</span><span class="p">:</span><span class="s2">"Please use HTTPS protocol"</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Since Kong 1.0 itâ€™s possible to create routes for raw TCP (not necessarily HTTP)
connections by using <code class="highlighter-rouge">"tcp"</code> in the <code class="highlighter-rouge">protocols</code> attribute:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"protocols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tcp"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Similarly, we can create routes which accept raw TLS traffic (not necessarily HTTPS) with
the <code class="highlighter-rouge">"tls"</code> value:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"protocols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tls"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>A Route with <em>only</em> <code class="highlighter-rouge">TLS</code> would <em>only</em> accept traffic over TLS.</p>

<p>It is also possible to accept both TCP and TLS simultaneously:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
    "hosts": ["..."],
    "paths": ["..."],
    "methods": ["..."],
    "protocols": ["tcp", "tls"],
    "service": {
        "id": "..."
    }
}

</code></pre></div></div>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="proxy-websocket-traffic">Proxy WebSocket traffic</h2>

<p>Kong supports WebSocket traffic thanks to the underlying Nginx implementation.
When you wish to establish a WebSocket connection between a client and your
upstream services <em>through</em> Kong, you must establish a WebSocket handshake.
This is done via the HTTP Upgrade mechanism. This is what your client request
made to Kong would look like:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">Upgrade</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">my-websocket-api.com</span>
<span class="na">Upgrade</span><span class="p">:</span> <span class="s">WebSocket</span>
</code></pre></div></div>

<p>This will make Kong forward the <code class="highlighter-rouge">Connection</code> and <code class="highlighter-rouge">Upgrade</code> headers to your
upstream service, instead of dismissing them due to the hop-by-hop nature of a
standard HTTP proxy.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h3 id="websocket-and-tls">WebSocket and TLS</h3>

<p>Kong will accept <code class="highlighter-rouge">ws</code> and <code class="highlighter-rouge">wss</code> connections on its respective <code class="highlighter-rouge">http</code> and
<code class="highlighter-rouge">https</code> ports. To enforce TLS connections from clients, set the <code class="highlighter-rouge">protocols</code>
property of the <a href="/1.1.x/admin-api/#add-route">Route</a> to <code class="highlighter-rouge">https</code> only.</p>

<p>When setting up the <a href="/1.1.x/admin-api/#add-service">Service</a> to point to your upstream
WebSocket service, you should carefully pick the protocol you want to use
between Kong and the upstream. If you want to use TLS (<code class="highlighter-rouge">wss</code>), then the
upstream WebSocket service must be defined using the <code class="highlighter-rouge">https</code> protocol in the
Service <code class="highlighter-rouge">protocol</code> property, and the proper port (usually 443). To connect
without TLS (<code class="highlighter-rouge">ws</code>), then the <code class="highlighter-rouge">http</code> protocol and port (usually 80) should be
used in <code class="highlighter-rouge">protocol</code> instead.</p>

<p>If you want Kong to terminate SSL/TLS, you can accept <code class="highlighter-rouge">wss</code> only from the
client, but proxy to the upstream service over plain text, or <code class="highlighter-rouge">ws</code>.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>

<h2 id="conclusion">Conclusion</h2>

<p>Through this guide, we hope you gained knowledge of the underlying proxying
mechanism of Kong, from how does a request match a Route to be routed to its
associated Service, on to how to allow for using the WebSocket protocol or
setup dynamic SSL certificates.</p>

<p>This website is Open-Source and can be found at
<a href="https://github.com/Kong/docs.konghq.com/">github.com/Kong/docs.konghq.com</a>.
Feel free to provide feedback to this document there, or propose improvements!</p>

<p>If you havenâ€™t already, we suggest that you also read the <a href="/1.1.x/loadbalancing">Load balancing
Reference</a>, as it closely relates to the topic we
just covered.</p>

<p><a href="#table-of-contents">Back to TOC</a></p>



          
        </div>
      </div>
    </div>
  </div>
  <div id="scroll-to-top-button">
    <i class="fas fa-chevron-up"></i>
  </div>
  
  <div class="feedback-widget-container">
  <input id="feedback-widget-checkbox" type="checkbox">
  <label for="feedback-widget-checkbox">
    <i class="fas fa-thumbs-up"></i>
  </label>
  <div class="feedback-container">
    <div class="feedback-thankyou">
      Thank you for your feedback.
    </div>
    <div class="feedback-comment">
      <textarea id="feedback-comment-text" rows="3" placeholder="Please let us know what we can improve on this page..."></textarea>
      <div class="feedback-comment-buttons">
        <button id="feedback-comment-button-back">Back</button>
        <button id="feedback-comment-button-submit" class="button-primary">Submit</button>
      </div>
    </div>
    <div class="feedback-options">
      <div class="feedback-options-title">Was this page useful?</div>
      <div class="feedback-options-buttons">
        <i data-feedback-result="yes" class="feedback-options-button far fa-thumbs-up"></i>
        <i data-feedback-result="no" class="feedback-options-button far fa-thumbs-down"></i>
      </div>
    </div>
  </div>
</div>

  
</div>
<style>
  @media (max-width: 768px) {
    .algolia-docsearch-suggestion--subcategory-column{
      display: none !important;
    }
  }
</style>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>


<script type="text/javascript">
  docsearch({
    apiKey: '691286ef280379144076a4f8df47a1d1',
    indexName: 'getkong',
    inputSelector: '#getkong-algolia-search-input',
    algoliaOptions: {
      hitsPerPage: 5,
      'facetFilters': ["version: 1.1.x"]
    },
    // Override selected event to allow for local environment navigation
    handleSelected: function (input, event, suggestion) {
      input.setVal('');
      window.location.href = window.location.protocol + "//" + window.location.host + suggestion.url.split(
        "docs.konghq.com")[1]
    }
    // ,debug: true // Set debug to true if you want to inspect the dropdown
  });
</script>




<div id="image-modal" data-image-expand-disabled="">
  <div class="image-modal-backdrop"></div>
  <div class="image-container">
    <img src="" alt="image">
    <i class="fa fa-times"></i>
  </div>
</div>



    
<footer class="marketing-footer--light-gray">
  <section>
    <ul class="newsletter">
      <li class="logo-wrapper">
        <div class="logo">
          <img src="/assets/images/Kogo-gradient.svg" alt="Kong" />
        </div>
        <div class="form">
            <iframe src="https://go.konghq.com/l/392112/2019-02-14/bhxq9c" width="100%" height="60" type="text/html" frameborder="0" allowTransparency="true" scrolling="no" style="overflow:hidden; border: 0"></iframe>
        </div>
        <div class="social">

          <div class="social-link">
            <a href="https://www.facebook.com/konghq/" title="Facebook"
              ><i
                aria-label="Facebook"
                class="fa fa-facebook-official"
                aria-hidden="true"
              ></i
            ></a>
          </div>
          <div class="social-link">
            <a href="https://twitter.com/thekonginc" title="Twitter"
              ><i
                aria-label="Twitter"
                class="fa fa-twitter"
                aria-hidden="true"
              ></i
            ></a>
          </div>
          <div class="social-link">
            <a href="https://www.meetup.com/topics/kong/all/" title="Meetup"
              ><i
              aria-label="Meetup"
              class="fa fa-meetup"
              aria-hidden="true"
            ></i
          ></a>
          </div>
          <div class="social-link">
            <a href="https://linkedin.com/company/278819" title="LinkedIn"
              ><i aria-label="GitHub" class="fa fa-linkedin" aria-hidden="true"></i
            ></a>
          </div>
          <div class="social-link">
            <a href="https://github.com/kong/kong" target="blank" class="btn-gh">
              <i class="fa fa-github" aria-hidden="true" aria-label="GitHub"></i> Star
            </a>
          </div>
        </div>
      </li>
      <li>
        <nav>
          <h5>Products</h5>
          <ul>
            <li><a href="http://konghq.com/kong/">Kong</a></li>
            <li><a href="http://konghq.com/kong-enterprise/">Kong Enterprise</a></li>
            <li><a href="http://konghq.com/kong-enterprise/studio/">Kong Studio</a></li>
            <li><a href="http://konghq.com/subscriptions/">Subscriptions</a></li>
          </ul>
        </nav>
      </li>
      <li>
        <nav>
          <h5>Resources</h5>
          <ul>
            <li>
              <a href="https://support.konghq.com" target="blank"
                >Enterprise Support</a
              >
            </li>
            <li>
              <a href="https://docs.konghq.com">Documentation</a>
            </li>
            <li><a href="http://konghq.com/partners/">Partners</a></li>
            <li><a href="http://konghq.com/resources/?content=webinars&itm_source=website&itm_medium=footer-nav">Webinars</a></li>
            <li><a href="http://konghq.com/resources/?content=ebooks&itm_source=website&itm_medium=footer-nav">Ebooks</a></li>
            <li><a href="http://konghq.com/resources/?content=whitepaper&itm_source=website&itm_medium=footer-nav">Briefs</a></li>
          </ul>
        </nav>
      </li>
      <li>
        <nav>
          <h5>Company</h5>
          <ul>
            <li><a href="http://konghq.com/about-kong-inc/">About</a></li>
            <li><a href="http://konghq.com/customers/">Customers</a></li>
            <li><a href="http://konghq.com/investors/">Investors</a></li>
            <li><a href="http://konghq.com/blog/">News</a></li>
            <li>
              <a href="http://konghq.com/careers/">Careers <span>Hiring!</span></a>
            </li>
            <li><a href="http://konghq.com/kong-summit/">Kong Summit</a></li>
            <li><a href="http://konghq.com/contact/">Contact</a></li>
          </ul>
        </nav>
      </li>
      <li>
        <nav>
          <h5>Open Source</h5>
          <ul>
            <li><a href="http://konghq.com/install/">Install</a></li>
            <li><a target="blank" href="https://github.com/Kong/">GitHub</a></li>
            <li><a href="https://discuss.konghq.com/"">Kong Nation</a></li>
            <li><a href="http://konghq.com/community/">Community</a></li>
          </ul>
        </nav>
      </li>
    </ul>
  </section>

  <section class="legal">
    <ul>
      <li>
        <span class="mashape-footer-content">&copy; Kong Inc. 2020 &nbsp; <a href="http://konghq.com/terms/">Terms</a><b>â€¢</b><a href="http://konghq.com/privacy/">Privacy</a></span>
      </li>
    </ul>
  </section>

  <script type="text/javascript">
    function onSubmit(response) {
      document.getElementById('subscription_form').submit();
      document.getElementById('follow_up_subscription_form').submit();
      if (response.length == 0) {
        alert('reCaptcha verification failed');
      }
    }
  </script>
</footer>
 <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<span class=\"sr-only\">Permalink</span><i class=\"fa fa-link\"></i>";
    anchor.title = "Permalink";
    return anchor;
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var className =
        ".show-anchor-links h1, .show-anchor-links h2, .show-anchor-links h3, " +
        ".show-anchor-links h4, .show-anchor-links h5, .show-anchor-links h6";
      var headers = document.querySelectorAll(className);

      for (var i = 0; i < headers.length; i++) {
        var header = headers[i];
        if (typeof header.id !== "undefined" && header.id !== "") {
          header.prepend(anchorForId(header.id));
        }
      }
    }
  };
</script>


    <script src="/assets/app.js?v=1591123015"></script>

    <div id="fb-root"></div>

    <script
      src="https://2tjosk2rxzc21medji3nfn1g-wpengine.netdna-ssl.com/wp-content/themes/konghq/assets/js/vendor/bootstrap.min.js"
      async
      defer
    ></script>

    <script
      id="github-bjs"
      src="https://buttons.github.io/buttons.js"
      async
      defer
    ></script>
    <script
      id="twitter-wjs"
      type="text/javascript"
      src="https://platform.twitter.com/widgets.js"
      async
      defer
    ></script>
    <script
      id="facebook-jssdk"
      type="text/javascript"
      src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=842731852424506"
      async
      defer
    ></script>

    <script type="text/javascript">
      piAId = '393112';
      piCId = '48375';

      (function() {
        function async_load() {
          var s = document.createElement('script');
          s.type = 'text/javascript';
          s.src =
            ('https:' == document.location.protocol
              ? 'https://pi'
              : 'http://cdn') + '.pardot.com/pd.js';
          var c = document.getElementsByTagName('script')[0];
          c.parentNode.insertBefore(s, c);
        }
        if (window.attachEvent) {
          window.attachEvent('onload', async_load);
        } else {
          window.addEventListener('load', async_load, false);
        }
      })();
    </script>

    <script type="text/javascript">
      var _vwo_code = (function() {
        var account_id = 125292,
          settings_tolerance = 2000,
          library_tolerance = 2500,
          use_existing_jquery = true,
          // DO NOT EDIT BELOW THIS LINE
          f = false,
          d = document;
        return {
          use_existing_jquery: function() {
            return use_existing_jquery;
          },
          library_tolerance: function() {
            return library_tolerance;
          },
          finish: function() {
            if (!f) {
              f = true;
              var a = d.getElementById('_vis_opt_path_hides');
              if (a) a.parentNode.removeChild(a);
            }
          },
          finished: function() {
            return f;
          },
          load: function(a) {
            var b = d.createElement('script');
            b.src = a;
            b.type = 'text/javascript';
            b.innerText;
            b.onerror = function() {
              _vwo_code.finish();
            };
            d.getElementsByTagName('head')[0].appendChild(b);
          },
          init: function() {
            settings_timer = setTimeout(
              '_vwo_code.finish()',
              settings_tolerance
            );
            this.load(
              '//dev.visualwebsiteoptimizer.com/j.php?a=' +
                account_id +
                '&u=' +
                encodeURIComponent(d.URL) +
                '&r=' +
                Math.random()
            );
            var a = d.createElement('style'),
              b = '',
              h = d.getElementsByTagName('head')[0];
            a.setAttribute('id', '_vis_opt_path_hides');
            a.setAttribute('type', 'text/css');
            if (a.styleSheet) a.styleSheet.cssText = b;
            else a.appendChild(d.createTextNode(b));
            h.appendChild(a);
            return settings_timer;
          }
        };
      })();
      _vwo_settings_timer = _vwo_code.init();
    </script>

    <script type="text/javascript">
      !(function() {
        var analytics = (window.analytics = window.analytics || []);
        if (!analytics.initialize)
          if (analytics.invoked)
            window.console &&
              console.error &&
              console.error('Segment snippet included twice.');
          else {
            analytics.invoked = !0;
            analytics.methods = [
              'trackSubmit',
              'trackClick',
              'trackLink',
              'trackForm',
              'pageview',
              'identify',
              'group',
              'track',
              'ready',
              'alias',
              'page',
              'once',
              'off',
              'on'
            ];
            analytics.factory = function(t) {
              return function() {
                var e = Array.prototype.slice.call(arguments);
                e.unshift(t);
                analytics.push(e);
                return analytics;
              };
            };
            for (var t = 0; t < analytics.methods.length; t++) {
              var e = analytics.methods[t];
              analytics[e] = analytics.factory(e);
            }
            analytics.load = function(t) {
              var e = document.createElement('script');
              e.type = 'text/javascript';
              e.async = !0;
              e.src =
                ('https:' === document.location.protocol
                  ? 'https://'
                  : 'http://') +
                'cdn.segment.com/analytics.js/v1/' +
                t +
                '/analytics.min.js';
              var n = document.getElementsByTagName('script')[0];
              n.parentNode.insertBefore(e, n);
            };
            analytics.SNIPPET_VERSION = '3.0.1';
            analytics.load('WDj0nSS7hpyxwL3evgbOzK755s0NUye6');
            analytics.page();
          }
      })();
    </script>

    <script>
      // Collapse Toggler
      $('button[data-toggle="kong-expand"]').on('click', function(e) {
        e.stopPropagation();
        var $this = $(this);
        $('#oss_subnav.expand').toggleClass('slideup');
        $($this.data('target')).toggleClass('kong-navbar-collapse--expand');
        $('nav.navbar.full-width').toggleClass('kong-navbar-collapse--expand');
        $this.toggleClass('active').attr('aria-expanded', true);
        $('.kong-navbar-collapse_section').removeClass('shift');
        $('.subnav, .trigger, .remove').removeClass('active');
        setTimeout(function() {
          $('#menu-primary-nav li').removeClass('active');
          $('.active-tab').removeClass('active-tab');
        }, 100);
      });

      var $window = $(window);

      function checkWidth() {
        var windowsize = $window.width();
        if (windowsize > 1080) {
          $('.navbar').removeClass('mobile-triggers');
          $('#menu-primary-nav li').removeClass('active');
          $('.active-tab').removeClass('active-tab');
        } else {
          $('.navbar').addClass('mobile-triggers');
        }
      }
      // Execute on load
      checkWidth();
      // Bind event listener
      $(window).resize(checkWidth);

      $('#menu-primary-nav .nav1 > a').click(function() {
        if ($('nav.navbar').hasClass('mobile-triggers')) {
          event.preventDefault();
          $('.nav3').removeClass('active');
          var position = $(this)
            .parent()
            .position();
          $(this)
            .parent()
            .toggleClass('active');
          $('body')
            .get(0)
            .style.setProperty(
              '--navPosition',
              (position.top - 75) * -1 + 'px'
            );
          $(this)
            .parent()
            .parent()
            .toggleClass('active-tab');
        }
      });

      $('#menu-primary-nav .nav3 > a').click(function() {
        if ($('nav.navbar').hasClass('mobile-triggers')) {
          event.preventDefault();
          $(this)
            .parent()
            .toggleClass('active');
        }
      });
    </script>
  </body>

  
</html>
